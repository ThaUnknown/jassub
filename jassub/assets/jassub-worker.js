var Module=Module,out=r=>console.log(r),err=r=>console.error(r);function ready(){}self.assert||(self.assert=(r,t)=>{if(!r)throw t});String.prototype.startsWith||(String.prototype.startsWith=function(r,t){return t===void 0&&(t=0),this.substring(t,r.length)===r});String.prototype.includes||(String.prototype.includes=function(r,t){return this.indexOf(r,t)!==-1});if(!ArrayBuffer.isView){const r=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];ArrayBuffer.isView=t=>t&&t.constructor&&r.indexOf(t.constructor)!==-1}Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(r,t){return new Uint8Array(this.subarray(r,t))});Date.now||(Date.now=()=>new Date().getTime());"performance"in self||(self.performance={now:()=>Date.now()});if(typeof console>"u"){const r=(t,n)=>{postMessage({target:"console",command:t,content:JSON.stringify(Array.prototype.slice.call(n))})};console={log:function(){r("log",arguments)},debug:function(){r("debug",arguments)},info:function(){r("info",arguments)},warn:function(){r("warn",arguments)},error:function(){r("error",arguments)}},console.log("Detected lack of console, overridden console")}const read_=(r,t)=>{const n=new XMLHttpRequest;return n.open("GET",r,!1),n.responseType=t?"arraybuffer":"text",n.send(null),n.response},readAsync=(r,t,n)=>{const i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=()=>{if((i.status===200||i.status===0)&&i.response)return t(i.response);n()},i.onerror=n,i.send(null)};Module={wasm:WebAssembly&&!WebAssembly.instantiateStreaming&&read_("jassub-worker.wasm",!0)};try{const r=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(!(r instanceof WebAssembly.Module)||!(new WebAssembly.Instance(r)instanceof WebAssembly.Instance))throw new Error("WASM not supported")}catch(e){console.warn(e),eval(read_("jassub-worker.wasm.js"))}ready=()=>postMessage({target:"ready"});out=r=>{r==="JASSUB: No usable fontconfig configuration file found, using fallback."?console.debug(r):console.log(r)};err=r=>{r==="Fontconfig error: Cannot load default config file: No such file: (null)"?console.debug(r):console.error(r)};let lastCurrentTime=0;const rate=1;let rafId=null,nextIsRaf=!1,lastCurrentTimeReceivedAt=Date.now(),targetFps=24,useLocalFonts=!1,blendMode="js",availableFonts={};const fontMap_={};let fontId=0,debug;self.width=0;self.height=0;let asyncRender=!1;self.addFont=({font:r})=>asyncWrite(r);const findAvailableFonts=r=>{r=r.trim().toLowerCase(),r.startsWith("@")&&(r=r.substring(1)),!fontMap_[r]&&(fontMap_[r]=!0,availableFonts[r]?asyncWrite(availableFonts[r]):useLocalFonts&&postMessage({target:"getLocalFont",font:r}))},asyncWrite=r=>{ArrayBuffer.isView(r)?allocFont(r):readAsync(r,t=>{allocFont(new Uint8Array(t))},console.error)},allocFont=r=>{const t=_malloc(r.byteLength);HEAPU8.set(r,t),jassubObj.addFont("font-"+fontId++,t,r.byteLength),jassubObj.reloadFonts()},processAvailableFonts=r=>{if(!availableFonts)return;const t=parseAss(r);for(let s=0;s<t.length;s++)for(let o=0;o<t[s].body.length;o++)t[s].body[o].key==="Style"&&findAvailableFonts(t[s].body[o].value.Fontname);const n=/\\fn([^\\}]*?)[\\}]/g;let i;for(;(i=n.exec(r))!==null;)findAvailableFonts(i[1])};self.setTrack=({content:r})=>{processAvailableFonts(r),jassubObj.createTrackMem(r),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],postMessage({target:"verifyColorSpace",subtitleColorSpace})};self.getColorSpace=()=>postMessage({target:"verifyColorSpace",subtitleColorSpace});self.freeTrack=()=>{jassubObj.removeTrack()};self.setTrackByUrl=({url:r})=>{self.setTrack({content:read_(r)})};const getCurrentTime=()=>{const r=(Date.now()-lastCurrentTimeReceivedAt)/1e3;return _isPaused?lastCurrentTime:(r>5&&(console.error("Didn't received currentTime > 5 seconds. Assuming video was paused."),setIsPaused(!0)),lastCurrentTime+r*rate)},setCurrentTime=r=>{lastCurrentTime=r,lastCurrentTimeReceivedAt=Date.now(),rafId||(nextIsRaf?rafId=requestAnimationFrame(renderLoop):(renderLoop(),setTimeout(()=>{nextIsRaf=!1},20)))};let _isPaused=!0;const setIsPaused=r=>{r!==_isPaused&&(_isPaused=r,r?rafId&&(clearTimeout(rafId),rafId=null):(lastCurrentTimeReceivedAt=Date.now(),rafId=requestAnimationFrame(renderLoop)))},a="BT601",b="BT709",c="SMPTE240M",d="FCC",libassYCbCrMap=[null,a,null,a,a,b,b,c,c,d,d],render=(r,t)=>{const n={},i=performance.now(),s=blendMode==="wasm"?jassubObj.renderBlend(r,t||0):jassubObj.renderImage(r,t||0);if(debug){const o=performance.now(),u=jassubObj.time;n.WASMRenderTime=u-i,n.WASMBitmapDecodeTime=o-u,n.JSRenderTime=Date.now()}if(jassubObj.changed!==0||t){const o=[],u=[];if(!s)return paintImages({images:o,buffers:u,times:n});if(asyncRender){const l=[];for(let g=s,f=0;f<jassubObj.count;g=g.next,++f){const p={w:g.w,h:g.h,x:g.x,y:g.y},h=g.image;l.push(createImageBitmap(new ImageData(HEAPU8C.subarray(h,h+p.w*p.h*4),p.w,p.h))),o.push(p)}Promise.all(l).then(g=>{for(let f=0;f<o.length;f++)o[f].image=g[f];debug&&(n.JSBitmapGenerationTime=Date.now()-n.JSRenderTime),paintImages({images:o,buffers:g,times:n})})}else{for(let l=s,g=0;g<jassubObj.count;l=l.next,++g){const f={w:l.w,h:l.h,x:l.x,y:l.y,image:l.image};if(!offCanvasCtx){const p=wasmMemory.buffer.slice(l.image,l.image+l.w*l.h*4);u.push(p),f.image=p}o.push(f)}paintImages({images:o,buffers:u,times:n})}}else postMessage({target:"unbusy"})};self.demand=({time:r})=>{lastCurrentTime=r,render(r)};const renderLoop=r=>{rafId=0,render(getCurrentTime(),r),_isPaused||(rafId=requestAnimationFrame(renderLoop))},paintImages=({times:r,images:t,buffers:n})=>{const i={target:"render",asyncRender,images:t,times:r,width:self.width,height:self.height,colorSpace:subtitleColorSpace};if(offscreenRender){(offCanvas.height!==self.height||offCanvas.width!==self.width)&&(offCanvas.width=self.width,offCanvas.height=self.height),offCanvasCtx.clearRect(0,0,self.width,self.height);for(const s of t)s.image&&(asyncRender?(offCanvasCtx.drawImage(s.image,s.x,s.y),s.image.close()):(bufferCanvas.width=s.w,bufferCanvas.height=s.h,bufferCtx.putImageData(new ImageData(HEAPU8C.subarray(s.image,s.image+s.w*s.h*4),s.w,s.h),0,0),offCanvasCtx.drawImage(bufferCanvas,s.x,s.y)));if(offscreenRender==="hybrid"){if(!t.length)return postMessage(i);debug&&(r.bitmaps=t.length);try{const s=offCanvas.transferToImageBitmap();i.images=[{image:s,x:0,y:0}],i.asyncRender=!0,postMessage(i,[s])}catch{postMessage({target:"unbusy"})}}else{if(debug){r.JSRenderTime=Date.now()-r.JSRenderTime-(r.JSBitmapGenerationTime||0);let s=0;for(const o in r)s+=r[o];console.log("Bitmaps: "+t.length+" Total: "+(s|0)+"ms",r)}postMessage({target:"unbusy"})}}else postMessage(i,n)},parseAss=r=>{let t,n,i,s,o,u,l,g,f,p;const h=[],m=r.split(/[\r\n]+/g);for(g=0;g<m.length;g++)if(t=m[g].match(/^\[(.*)\]$/),t)n=null,h.push({name:t[1],body:[]});else{if(/^\s*$/.test(m[g])||h.length===0)continue;if(p=h[h.length-1].body,m[g][0]===";")p.push({type:"comment",value:m[g].substring(1)});else{if(s=m[g].split(":"),o=s[0],u=s.slice(1).join(":").trim(),(n||o==="Format")&&(u=u.split(","),n&&u.length>n.length&&(i=u.slice(n.length-1).join(","),u=u.slice(0,n.length-1),u.push(i)),u=u.map(y=>y.trim()),n)){for(l={},f=0;f<u.length;f++)l[n[f]]=u[f];u=l}o==="Format"&&(n=u),p.push({key:o,value:u})}}return h},requestAnimationFrame=(()=>{let r=0;return t=>{const n=Date.now();if(r===0)r=n+1e3/targetFps;else for(;n+2>=r;)r+=1e3/targetFps;const i=Math.max(r-n,0);return setTimeout(t,i)}})(),_applyKeys=(r,t)=>{for(const n of Object.keys(r))t[n]=r[n]};let offCanvas,offCanvasCtx,offscreenRender,bufferCanvas,bufferCtx,jassubObj,subtitleColorSpace;self.init=r=>{self.width=r.width,self.height=r.height,blendMode=r.blendMode,asyncRender=r.asyncRender,asyncRender&&typeof createImageBitmap>"u"&&(asyncRender=!1,console.error("'createImageBitmap' needed for 'asyncRender' unsupported!")),availableFonts=r.availableFonts,debug=r.debug,targetFps=r.targetFps||targetFps,useLocalFonts=r.useLocalFonts;const t=r.fallbackFont.toLowerCase();jassubObj=new Module.JASSUB(self.width,self.height,t||null,debug),t&&findAvailableFonts(t);let n=r.subContent;n||(n=read_(r.subUrl)),processAvailableFonts(n);for(const i of r.fonts||[])asyncWrite(i);jassubObj.createTrackMem(n),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],postMessage({target:"verifyColorSpace",subtitleColorSpace}),jassubObj.setDropAnimations(r.dropAllAnimations||0),(r.libassMemoryLimit>0||r.libassGlyphLimit>0)&&jassubObj.setMemoryLimits(r.libassGlyphLimit||0,r.libassMemoryLimit||0)};self.offscreenCanvas=({transferable:r})=>{offCanvas=r[0],offCanvasCtx=offCanvas.getContext("2d"),asyncRender||(bufferCanvas=new OffscreenCanvas(self.height,self.width),bufferCtx=bufferCanvas.getContext("2d",{desynchronized:!0})),offscreenRender=!0};self.detachOffscreen=()=>{offCanvas=new OffscreenCanvas(self.height,self.width),offCanvasCtx=offCanvas.getContext("2d",{desynchronized:!0}),offscreenRender="hybrid"};self.canvas=({width:r,height:t,force:n})=>{if(r==null)throw new Error("Invalid canvas size specified");self.width=r,self.height=t,jassubObj.resizeCanvas(r,t),n&&render(lastCurrentTime,!0)};self.video=({currentTime:r,isPaused:t,rate:n})=>{r!=null&&setCurrentTime(r),t!=null&&setIsPaused(t),n=n||n};self.destroy=()=>{jassubObj.quitLibrary()};self.createEvent=({event:r})=>{_applyKeys(r,jassubObj.getEvent(jassubObj.allocEvent()))};self.getEvents=()=>{const r=[];for(let t=0;t<jassubObj.getEventCount();t++){const{Start:n,Duration:i,ReadOrder:s,Layer:o,Style:u,MarginL:l,MarginR:g,MarginV:f,Name:p,Text:h,Effect:m}=jassubObj.getEvent(t);r.push({Start:n,Duration:i,ReadOrder:s,Layer:o,Style:u,MarginL:l,MarginR:g,MarginV:f,Name:p,Text:h,Effect:m})}postMessage({target:"getEvents",events:r})};self.setEvent=({event:r,index:t})=>{_applyKeys(r,jassubObj.getEvent(t))};self.removeEvent=({index:r})=>{jassubObj.removeEvent(r)};self.createStyle=({style:r})=>{_applyKeys(r,jassubObj.getStyle(jassubObj.allocStyle()))};self.getStyles=()=>{const r=[];for(let t=0;t<jassubObj.getStyleCount();t++){const{Name:n,FontName:i,FontSize:s,PrimaryColour:o,SecondaryColour:u,OutlineColour:l,BackColour:g,Bold:f,Italic:p,Underline:h,StrikeOut:m,ScaleX:y,ScaleY:v,Spacing:w,Angle:_,BorderStyle:T,Outline:P,Shadow:C,Alignment:S,MarginL:E,MarginR:A,MarginV:F,Encoding:$,treat_fontname_as_pattern:M,Blur:U,Justify:H}=jassubObj.getStyle(t);r.push({Name:n,FontName:i,FontSize:s,PrimaryColour:o,SecondaryColour:u,OutlineColour:l,BackColour:g,Bold:f,Italic:p,Underline:h,StrikeOut:m,ScaleX:y,ScaleY:v,Spacing:w,Angle:_,BorderStyle:T,Outline:P,Shadow:C,Alignment:S,MarginL:E,MarginR:A,MarginV:F,Encoding:$,treat_fontname_as_pattern:M,Blur:U,Justify:H})}postMessage({target:"getStyles",time:Date.now(),styles:r})};self.setStyle=({style:r,index:t})=>{_applyKeys(r,jassubObj.getStyle(t))};self.removeStyle=({index:r})=>{jassubObj.removeStyle(r)};onmessage=({data:r})=>{if(self[r.target])self[r.target](r);else throw new Error("Unknown event target "+r.target)};let HEAPU8C=null;updateMemoryViews=(r=>()=>{r(),HEAPU8C=new Uint8ClampedArray(wasmMemory.buffer)})(updateMemoryViews);function abort(r){throw r}var HEAP8,HEAP16,HEAP32,HEAPU8,HEAPU16,HEAPU32,HEAPF32,HEAPF64,wasmMemory,wasmTable;function updateMemoryViews(){var r=wasmMemory.buffer;HEAP8=new Int8Array(r),HEAP16=new Int16Array(r),HEAP32=new Int32Array(r),HEAPU8=new Uint8Array(r),HEAPU16=new Uint16Array(r),HEAPU32=new Uint32Array(r),HEAPF32=new Float32Array(r),HEAPF64=new Float64Array(r)}wasmMemory=new WebAssembly.Memory({initial:256,maximum:32768});updateMemoryViews();(!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=(r,t)=>{var n=r>>>16,i=r&65535,s=t>>>16,o=t&65535;return i*o+(n*o+i*s<<16)|0});if(!Math.fround){var froundBuffer=new Float32Array(1);Math.fround=r=>(froundBuffer[0]=r,froundBuffer[0])}Math.clz32||(Math.clz32=r=>{var t=32,n=r>>16;return n&&(t-=16,r=n),n=r>>8,n&&(t-=8,r=n),n=r>>4,n&&(t-=4,r=n),n=r>>2,n&&(t-=2,r=n),n=r>>1,n?t-2:t-r});Math.trunc||(Math.trunc=r=>r<0?Math.ceil(r):Math.floor(r));var UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function UTF8ArrayToString(r,t,n){for(var i=t+n,s=t;r[s]&&!(s>=i);)++s;if(s-t>16&&r.buffer&&UTF8Decoder)return UTF8Decoder.decode(r.subarray(t,s));for(var o="";t<s;){var u=r[t++];if(!(u&128)){o+=String.fromCharCode(u);continue}var l=r[t++]&63;if((u&224)==192){o+=String.fromCharCode((u&31)<<6|l);continue}var g=r[t++]&63;if((u&240)==224?u=(u&15)<<12|l<<6|g:u=(u&7)<<18|l<<12|g<<6|r[t++]&63,u<65536)o+=String.fromCharCode(u);else{var f=u-65536;o+=String.fromCharCode(55296|f>>10,56320|f&1023)}}return o}function UTF8ToString(r,t){return r?UTF8ArrayToString(HEAPU8,r,t):""}function ___assert_fail(r,t,n,i){abort(`Assertion failed: ${UTF8ToString(r)}, at: `+[t?UTF8ToString(t):"unknown filename",n,i?UTF8ToString(i):"unknown function"])}function ___syscall_fcntl64(r,t,n){return 0}function ___syscall_fstat64(r,t){}function stringToUTF8Array(r,t,n,i){if(!(i>0))return 0;for(var s=n,o=n+i-1,u=0;u<r.length;++u){var l=r.charCodeAt(u);if(l>=55296&&l<=57343){var g=r.charCodeAt(++u);l=65536+((l&1023)<<10)|g&1023}if(l<=127){if(n>=o)break;t[n++]=l}else if(l<=2047){if(n+1>=o)break;t[n++]=192|l>>6,t[n++]=128|l&63}else if(l<=65535){if(n+2>=o)break;t[n++]=224|l>>12,t[n++]=128|l>>6&63,t[n++]=128|l&63}else{if(n+3>=o)break;t[n++]=240|l>>18,t[n++]=128|l>>12&63,t[n++]=128|l>>6&63,t[n++]=128|l&63}}return t[n]=0,n-s}function stringToUTF8(r,t,n){return stringToUTF8Array(r,HEAPU8,t,n)}function ___syscall_getdents64(r,t,n){}function ___syscall_ioctl(r,t,n){return 0}function ___syscall_newfstatat(r,t,n,i){}function ___syscall_openat(r,t,n,i){}function ___syscall_stat64(r,t){}function __embind_register_bigint(r,t,n,i,s){}function getShiftFromSize(r){switch(r){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+r)}}function embind_init_charCodes(){for(var r=new Array(256),t=0;t<256;++t)r[t]=String.fromCharCode(t);embind_charCodes=r}var embind_charCodes=void 0;function readLatin1String(r){for(var t="",n=r;HEAPU8[n];)t+=embind_charCodes[HEAPU8[n++]];return t}var awaitingDependencies={},registeredTypes={},typeDependencies={},char_0=48,char_9=57;function makeLegalFunctionName(r){if(r===void 0)return"_unknown";r=r.replace(/[^a-zA-Z0-9_]/g,"$");var t=r.charCodeAt(0);return t>=char_0&&t<=char_9?"_"+r:r}function createNamedFunction(r,t){return r=makeLegalFunctionName(r),{[r]:function(){return t.apply(this,arguments)}}[r]}function extendError(r,t){var n=createNamedFunction(t,function(i){this.name=t,this.message=i;var s=new Error(i).stack;s!==void 0&&(this.stack=this.toString()+`
`+s.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},n}var BindingError=void 0;function throwBindingError(r){throw new BindingError(r)}var InternalError=void 0;function throwInternalError(r){throw new InternalError(r)}function whenDependentTypesAreResolved(r,t,n){r.forEach(function(l){typeDependencies[l]=t});function i(l){var g=n(l);g.length!==r.length&&throwInternalError("Mismatched type converter count");for(var f=0;f<r.length;++f)registerType(r[f],g[f])}var s=new Array(t.length),o=[],u=0;t.forEach((l,g)=>{registeredTypes.hasOwnProperty(l)?s[g]=registeredTypes[l]:(o.push(l),awaitingDependencies.hasOwnProperty(l)||(awaitingDependencies[l]=[]),awaitingDependencies[l].push(()=>{s[g]=registeredTypes[l],++u,u===o.length&&i(s)}))}),o.length===0&&i(s)}function registerType(r,t,n={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(r||throwBindingError(`type "${i}" must have a positive integer typeid pointer`),registeredTypes.hasOwnProperty(r)){if(n.ignoreDuplicateRegistrations)return;throwBindingError(`Cannot register type '${i}' twice`)}if(registeredTypes[r]=t,delete typeDependencies[r],awaitingDependencies.hasOwnProperty(r)){var s=awaitingDependencies[r];delete awaitingDependencies[r],s.forEach(o=>o())}}function __embind_register_bool(r,t,n,i,s){var o=getShiftFromSize(n);t=readLatin1String(t),registerType(r,{name:t,fromWireType:function(u){return!!u},toWireType:function(u,l){return l?i:s},argPackAdvance:8,readValueFromPointer:function(u){var l;if(n===1)l=HEAP8;else if(n===2)l=HEAP16;else if(n===4)l=HEAP32;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(l[u>>o])},destructorFunction:null})}function ClassHandle_isAliasOf(r){if(!(this instanceof ClassHandle)||!(r instanceof ClassHandle))return!1;for(var t=this.$$.ptrType.registeredClass,n=this.$$.ptr,i=r.$$.ptrType.registeredClass,s=r.$$.ptr;t.baseClass;)n=t.upcast(n),t=t.baseClass;for(;i.baseClass;)s=i.upcast(s),i=i.baseClass;return t===i&&n===s}function shallowCopyInternalPointer(r){return{count:r.count,deleteScheduled:r.deleteScheduled,preservePointerOnDelete:r.preservePointerOnDelete,ptr:r.ptr,ptrType:r.ptrType,smartPtr:r.smartPtr,smartPtrType:r.smartPtrType}}function throwInstanceAlreadyDeleted(r){function t(n){return n.$$.ptrType.registeredClass.name}throwBindingError(t(r)+" instance already deleted")}var finalizationRegistry=!1;function detachFinalizer(r){}function runDestructor(r){r.smartPtr?r.smartPtrType.rawDestructor(r.smartPtr):r.ptrType.registeredClass.rawDestructor(r.ptr)}function releaseClassHandle(r){r.count.value-=1;var t=r.count.value===0;t&&runDestructor(r)}function downcastPointer(r,t,n){if(t===n)return r;if(n.baseClass===void 0)return null;var i=downcastPointer(r,t,n.baseClass);return i===null?null:n.downcast(i)}var registeredPointers={};function getInheritedInstanceCount(){return Object.keys(registeredInstances).length}function getLiveInheritedInstances(){var r=[];for(var t in registeredInstances)registeredInstances.hasOwnProperty(t)&&r.push(registeredInstances[t]);return r}var deletionQueue=[];function flushPendingDeletes(){for(;deletionQueue.length;){var r=deletionQueue.pop();r.$$.deleteScheduled=!1,r.delete()}}var delayFunction=void 0;function setDelayFunction(r){delayFunction=r,deletionQueue.length&&delayFunction&&delayFunction(flushPendingDeletes)}function init_embind(){Module.getInheritedInstanceCount=getInheritedInstanceCount,Module.getLiveInheritedInstances=getLiveInheritedInstances,Module.flushPendingDeletes=flushPendingDeletes,Module.setDelayFunction=setDelayFunction}var registeredInstances={};function getBasestPointer(r,t){for(t===void 0&&throwBindingError("ptr should not be undefined");r.baseClass;)t=r.upcast(t),r=r.baseClass;return t}function getInheritedInstance(r,t){return t=getBasestPointer(r,t),registeredInstances[t]}function makeClassHandle(r,t){(!t.ptrType||!t.ptr)&&throwInternalError("makeClassHandle requires ptr and ptrType");var n=!!t.smartPtrType,i=!!t.smartPtr;return n!==i&&throwInternalError("Both smartPtrType and smartPtr must be specified"),t.count={value:1},attachFinalizer(Object.create(r,{$$:{value:t}}))}function RegisteredPointer_fromWireType(r){var t=this.getPointee(r);if(!t)return this.destructor(r),null;var n=getInheritedInstance(this.registeredClass,t);if(n!==void 0){if(n.$$.count.value===0)return n.$$.ptr=t,n.$$.smartPtr=r,n.clone();var i=n.clone();return this.destructor(r),i}function s(){return this.isSmartPointer?makeClassHandle(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:r}):makeClassHandle(this.registeredClass.instancePrototype,{ptrType:this,ptr:r})}var o=this.registeredClass.getActualType(t),u=registeredPointers[o];if(!u)return s.call(this);var l;this.isConst?l=u.constPointerType:l=u.pointerType;var g=downcastPointer(t,this.registeredClass,l.registeredClass);return g===null?s.call(this):this.isSmartPointer?makeClassHandle(l.registeredClass.instancePrototype,{ptrType:l,ptr:g,smartPtrType:this,smartPtr:r}):makeClassHandle(l.registeredClass.instancePrototype,{ptrType:l,ptr:g})}function attachFinalizer(r){return typeof FinalizationRegistry>"u"?(attachFinalizer=t=>t,r):(finalizationRegistry=new FinalizationRegistry(t=>{releaseClassHandle(t.$$)}),attachFinalizer=t=>{var n=t.$$,i=!!n.smartPtr;if(i){var s={$$:n};finalizationRegistry.register(t,s,t)}return t},detachFinalizer=t=>finalizationRegistry.unregister(t),attachFinalizer(r))}function ClassHandle_clone(){if(this.$$.ptr||throwInstanceAlreadyDeleted(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var r=attachFinalizer(Object.create(Object.getPrototypeOf(this),{$$:{value:shallowCopyInternalPointer(this.$$)}}));return r.$$.count.value+=1,r.$$.deleteScheduled=!1,r}function ClassHandle_delete(){this.$$.ptr||throwInstanceAlreadyDeleted(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&throwBindingError("Object already scheduled for deletion"),detachFinalizer(this),releaseClassHandle(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ClassHandle_isDeleted(){return!this.$$.ptr}function ClassHandle_deleteLater(){return this.$$.ptr||throwInstanceAlreadyDeleted(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&throwBindingError("Object already scheduled for deletion"),deletionQueue.push(this),deletionQueue.length===1&&delayFunction&&delayFunction(flushPendingDeletes),this.$$.deleteScheduled=!0,this}function init_ClassHandle(){ClassHandle.prototype.isAliasOf=ClassHandle_isAliasOf,ClassHandle.prototype.clone=ClassHandle_clone,ClassHandle.prototype.delete=ClassHandle_delete,ClassHandle.prototype.isDeleted=ClassHandle_isDeleted,ClassHandle.prototype.deleteLater=ClassHandle_deleteLater}function ClassHandle(){}function ensureOverloadTable(r,t,n){if(r[t].overloadTable===void 0){var i=r[t];r[t]=function(){return r[t].overloadTable.hasOwnProperty(arguments.length)||throwBindingError(`Function '${n}' called with an invalid number of arguments (${arguments.length}) - expects one of (${r[t].overloadTable})!`),r[t].overloadTable[arguments.length].apply(this,arguments)},r[t].overloadTable=[],r[t].overloadTable[i.argCount]=i}}function exposePublicSymbol(r,t,n){Module.hasOwnProperty(r)?((n===void 0||Module[r].overloadTable!==void 0&&Module[r].overloadTable[n]!==void 0)&&throwBindingError(`Cannot register public name '${r}' twice`),ensureOverloadTable(Module,r,r),Module.hasOwnProperty(n)&&throwBindingError(`Cannot register multiple overloads of a function with the same number of arguments (${n})!`),Module[r].overloadTable[n]=t):(Module[r]=t,n!==void 0&&(Module[r].numArguments=n))}function RegisteredClass(r,t,n,i,s,o,u,l){this.name=r,this.constructor=t,this.instancePrototype=n,this.rawDestructor=i,this.baseClass=s,this.getActualType=o,this.upcast=u,this.downcast=l,this.pureVirtualFunctions=[]}function upcastPointer(r,t,n){for(;t!==n;)t.upcast||throwBindingError(`Expected null or instance of ${n.name}, got an instance of ${t.name}`),r=t.upcast(r),t=t.baseClass;return r}function constNoSmartPtrRawPointerToWireType(r,t){if(t===null)return this.isReference&&throwBindingError("null is not a valid "+this.name),0;t.$$||throwBindingError(`Cannot pass "${embindRepr(t)}" as a ${this.name}`),t.$$.ptr||throwBindingError("Cannot pass deleted object as a pointer of type "+this.name);var n=t.$$.ptrType.registeredClass,i=upcastPointer(t.$$.ptr,n,this.registeredClass);return i}function genericPointerToWireType(r,t){var n;if(t===null)return this.isReference&&throwBindingError("null is not a valid "+this.name),this.isSmartPointer?(n=this.rawConstructor(),r!==null&&r.push(this.rawDestructor,n),n):0;t.$$||throwBindingError(`Cannot pass "${embindRepr(t)}" as a ${this.name}`),t.$$.ptr||throwBindingError(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&throwBindingError(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var i=t.$$.ptrType.registeredClass;if(n=upcastPointer(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&throwBindingError("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?n=t.$$.smartPtr:throwBindingError(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:n=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)n=t.$$.smartPtr;else{var s=t.clone();n=this.rawShare(n,Emval.toHandle(function(){s.delete()})),r!==null&&r.push(this.rawDestructor,n)}break;default:throwBindingError("Unsupporting sharing policy")}return n}function nonConstNoSmartPtrRawPointerToWireType(r,t){if(t===null)return this.isReference&&throwBindingError("null is not a valid "+this.name),0;t.$$||throwBindingError(`Cannot pass "${embindRepr(t)}" as a ${this.name}`),t.$$.ptr||throwBindingError(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&throwBindingError(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var n=t.$$.ptrType.registeredClass,i=upcastPointer(t.$$.ptr,n,this.registeredClass);return i}function simpleReadValueFromPointer(r){return this.fromWireType(HEAP32[r>>2])}function RegisteredPointer_getPointee(r){return this.rawGetPointee&&(r=this.rawGetPointee(r)),r}function RegisteredPointer_destructor(r){this.rawDestructor&&this.rawDestructor(r)}function RegisteredPointer_deleteObject(r){r!==null&&r.delete()}function init_RegisteredPointer(){RegisteredPointer.prototype.getPointee=RegisteredPointer_getPointee,RegisteredPointer.prototype.destructor=RegisteredPointer_destructor,RegisteredPointer.prototype.argPackAdvance=8,RegisteredPointer.prototype.readValueFromPointer=simpleReadValueFromPointer,RegisteredPointer.prototype.deleteObject=RegisteredPointer_deleteObject,RegisteredPointer.prototype.fromWireType=RegisteredPointer_fromWireType}function RegisteredPointer(r,t,n,i,s,o,u,l,g,f,p){this.name=r,this.registeredClass=t,this.isReference=n,this.isConst=i,this.isSmartPointer=s,this.pointeeType=o,this.sharingPolicy=u,this.rawGetPointee=l,this.rawConstructor=g,this.rawShare=f,this.rawDestructor=p,!s&&t.baseClass===void 0?i?(this.toWireType=constNoSmartPtrRawPointerToWireType,this.destructorFunction=null):(this.toWireType=nonConstNoSmartPtrRawPointerToWireType,this.destructorFunction=null):this.toWireType=genericPointerToWireType}function replacePublicSymbol(r,t,n){Module.hasOwnProperty(r)||throwInternalError("Replacing nonexistant public symbol"),Module[r].overloadTable!==void 0&&n!==void 0?Module[r].overloadTable[n]=t:(Module[r]=t,Module[r].argCount=n)}function dynCallLegacy(r,t,n){var i=dynCalls[r];return n&&n.length?i.apply(null,[t].concat(n)):i.call(null,t)}var wasmTableMirror=[];function getWasmTableEntry(r){var t=wasmTableMirror[r];return t||(r>=wasmTableMirror.length&&(wasmTableMirror.length=r+1),wasmTableMirror[r]=t=wasmTable.get(r)),t}function dynCall(r,t,n){if(r.includes("j"))return dynCallLegacy(r,t,n);var i=getWasmTableEntry(t).apply(null,n);return i}function getDynCaller(r,t){var n=[];return function(){return n.length=0,Object.assign(n,arguments),dynCall(r,t,n)}}function embind__requireFunction(r,t){r=readLatin1String(r);function n(){return r.includes("j")?getDynCaller(r,t):getWasmTableEntry(t)}var i=n();return typeof i!="function"&&throwBindingError(`unknown function pointer with signature ${r}: ${t}`),i}var UnboundTypeError=void 0;function getTypeName(r){var t=___getTypeName(r),n=readLatin1String(t);return _free(t),n}function throwUnboundTypeError(r,t){var n=[],i={};function s(o){if(!i[o]&&!registeredTypes[o]){if(typeDependencies[o]){typeDependencies[o].forEach(s);return}n.push(o),i[o]=!0}}throw t.forEach(s),new UnboundTypeError(r+": "+n.map(getTypeName).join([", "]))}function __embind_register_class(r,t,n,i,s,o,u,l,g,f,p,h,m){p=readLatin1String(p),o=embind__requireFunction(s,o),l&&(l=embind__requireFunction(u,l)),f&&(f=embind__requireFunction(g,f)),m=embind__requireFunction(h,m);var y=makeLegalFunctionName(p);exposePublicSymbol(y,function(){throwUnboundTypeError(`Cannot construct ${p} due to unbound types`,[i])}),whenDependentTypesAreResolved([r,t,n],i?[i]:[],function(v){v=v[0];var w,_;i?(w=v.registeredClass,_=w.instancePrototype):_=ClassHandle.prototype;var T=createNamedFunction(y,function(){if(Object.getPrototypeOf(this)!==P)throw new BindingError("Use 'new' to construct "+p);if(C.constructor_body===void 0)throw new BindingError(p+" has no accessible constructor");var F=C.constructor_body[arguments.length];if(F===void 0)throw new BindingError(`Tried to invoke ctor of ${p} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(C.constructor_body).toString()}) parameters instead!`);return F.apply(this,arguments)}),P=Object.create(_,{constructor:{value:T}});T.prototype=P;var C=new RegisteredClass(p,T,P,m,w,o,l,f);C.baseClass&&(C.baseClass.__derivedClasses===void 0&&(C.baseClass.__derivedClasses=[]),C.baseClass.__derivedClasses.push(C));var S=new RegisteredPointer(p,C,!0,!1,!1),E=new RegisteredPointer(p+"*",C,!1,!1,!1),A=new RegisteredPointer(p+" const*",C,!1,!0,!1);return registeredPointers[r]={pointerType:E,constPointerType:A},replacePublicSymbol(y,T),[S,E,A]})}function heap32VectorToArray(r,t){for(var n=[],i=0;i<r;i++)n.push(HEAPU32[t+i*4>>2]);return n}function runDestructors(r){for(;r.length;){var t=r.pop(),n=r.pop();n(t)}}function newFunc(r,t){if(!(r instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof r} which is not a function`);var n=createNamedFunction(r.name||"unknownFunctionName",function(){});n.prototype=r.prototype;var i=new n,s=r.apply(i,t);return s instanceof Object?s:i}function craftInvokerFunction(r,t,n,i,s,o){var u=t.length;u<2&&throwBindingError("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var l=t[1]!==null&&n!==null,g=!1,f=1;f<t.length;++f)if(t[f]!==null&&t[f].destructorFunction===void 0){g=!0;break}for(var p=t[0].name!=="void",h="",m="",f=0;f<u-2;++f)h+=(f!==0?", ":"")+"arg"+f,m+=(f!==0?", ":"")+"arg"+f+"Wired";var y="return function "+makeLegalFunctionName(r)+"("+h+`) {
if (arguments.length !== `+(u-2)+`) {
throwBindingError('function `+r+" called with ' + arguments.length + ' arguments, expected "+(u-2)+` args!');
}
`;g&&(y+=`var destructors = [];
`);var v=g?"destructors":"null",w=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],_=[throwBindingError,i,s,runDestructors,t[0],t[1]];l&&(y+="var thisWired = classParam.toWireType("+v+`, this);
`);for(var f=0;f<u-2;++f)y+="var arg"+f+"Wired = argType"+f+".toWireType("+v+", arg"+f+"); // "+t[f+2].name+`
`,w.push("argType"+f),_.push(t[f+2]);if(l&&(m="thisWired"+(m.length>0?", ":"")+m),y+=(p||o?"var rv = ":"")+"invoker(fn"+(m.length>0?", ":"")+m+`);
`,g)y+=`runDestructors(destructors);
`;else for(var f=l?1:2;f<t.length;++f){var T=f===1?"thisWired":"arg"+(f-2)+"Wired";t[f].destructorFunction!==null&&(y+=T+"_dtor("+T+"); // "+t[f].name+`
`,w.push(T+"_dtor"),_.push(t[f].destructorFunction))}return p&&(y+=`var ret = retType.fromWireType(rv);
return ret;
`),y+=`}
`,w.push(y),newFunc(Function,w).apply(null,_)}function __embind_register_class_constructor(r,t,n,i,s,o){assert(t>0);var u=heap32VectorToArray(t,n);s=embind__requireFunction(i,s),whenDependentTypesAreResolved([],[r],function(l){l=l[0];var g="constructor "+l.name;if(l.registeredClass.constructor_body===void 0&&(l.registeredClass.constructor_body=[]),l.registeredClass.constructor_body[t-1]!==void 0)throw new BindingError(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${l.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return l.registeredClass.constructor_body[t-1]=()=>{throwUnboundTypeError(`Cannot construct ${l.name} due to unbound types`,u)},whenDependentTypesAreResolved([],u,function(f){return f.splice(1,0,null),l.registeredClass.constructor_body[t-1]=craftInvokerFunction(g,f,null,s,o),[]}),[]})}function __embind_register_class_function(r,t,n,i,s,o,u,l,g){var f=heap32VectorToArray(n,i);t=readLatin1String(t),o=embind__requireFunction(s,o),whenDependentTypesAreResolved([],[r],function(p){p=p[0];var h=p.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),l&&p.registeredClass.pureVirtualFunctions.push(t);function m(){throwUnboundTypeError(`Cannot call ${h} due to unbound types`,f)}var y=p.registeredClass.instancePrototype,v=y[t];return v===void 0||v.overloadTable===void 0&&v.className!==p.name&&v.argCount===n-2?(m.argCount=n-2,m.className=p.name,y[t]=m):(ensureOverloadTable(y,t,h),y[t].overloadTable[n-2]=m),whenDependentTypesAreResolved([],f,function(w){var _=craftInvokerFunction(h,w,p,o,u,g);return y[t].overloadTable===void 0?(_.argCount=n-2,y[t]=_):y[t].overloadTable[n-2]=_,[]}),[]})}function validateThis(r,t,n){return r instanceof Object||throwBindingError(n+' with invalid "this": '+r),r instanceof t.registeredClass.constructor||throwBindingError(n+' incompatible with "this" of type '+r.constructor.name),r.$$.ptr||throwBindingError(`cannot call emscripten binding method ${n} on deleted object`),upcastPointer(r.$$.ptr,r.$$.ptrType.registeredClass,t.registeredClass)}function __embind_register_class_property(r,t,n,i,s,o,u,l,g,f){t=readLatin1String(t),s=embind__requireFunction(i,s),whenDependentTypesAreResolved([],[r],function(p){p=p[0];var h=p.name+"."+t,m={get:function(){throwUnboundTypeError(`Cannot access ${h} due to unbound types`,[n,u])},enumerable:!0,configurable:!0};return g?m.set=()=>{throwUnboundTypeError(`Cannot access ${h} due to unbound types`,[n,u])}:m.set=y=>{throwBindingError(h+" is a read-only property")},Object.defineProperty(p.registeredClass.instancePrototype,t,m),whenDependentTypesAreResolved([],g?[n,u]:[n],function(y){var v=y[0],w={get:function(){var T=validateThis(this,p,h+" getter");return v.fromWireType(s(o,T))},enumerable:!0};if(g){g=embind__requireFunction(l,g);var _=y[1];w.set=function(T){var P=validateThis(this,p,h+" setter"),C=[];g(f,P,_.toWireType(C,T)),runDestructors(C)}}return Object.defineProperty(p.registeredClass.instancePrototype,t,w),[]}),[]})}function HandleAllocator(){this.allocated=[void 0],this.freelist=[],this.get=function(r){return this.allocated[r]},this.allocate=function(r){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=r,t},this.free=function(r){this.allocated[r]=void 0,this.freelist.push(r)}}var emval_handles=new HandleAllocator;function __emval_decref(r){r>=emval_handles.reserved&&--emval_handles.get(r).refcount===0&&emval_handles.free(r)}function count_emval_handles(){for(var r=0,t=emval_handles.reserved;t<emval_handles.allocated.length;++t)emval_handles.allocated[t]!==void 0&&++r;return r}function init_emval(){emval_handles.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),emval_handles.reserved=emval_handles.allocated.length,Module.count_emval_handles=count_emval_handles}var Emval={toValue:r=>(r||throwBindingError("Cannot use deleted val. handle = "+r),emval_handles.get(r).value),toHandle:r=>{switch(r){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return emval_handles.allocate({refcount:1,value:r})}}};function __embind_register_emval(r,t){t=readLatin1String(t),registerType(r,{name:t,fromWireType:function(n){var i=Emval.toValue(n);return __emval_decref(n),i},toWireType:function(n,i){return Emval.toHandle(i)},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:null})}function embindRepr(r){if(r===null)return"null";var t=typeof r;return t==="object"||t==="array"||t==="function"?r.toString():""+r}function floatReadValueFromPointer(r,t){switch(t){case 2:return function(n){return this.fromWireType(HEAPF32[n>>2])};case 3:return function(n){return this.fromWireType(HEAPF64[n>>3])};default:throw new TypeError("Unknown float type: "+r)}}function __embind_register_float(r,t,n){var i=getShiftFromSize(n);t=readLatin1String(t),registerType(r,{name:t,fromWireType:function(s){return s},toWireType:function(s,o){return o},argPackAdvance:8,readValueFromPointer:floatReadValueFromPointer(t,i),destructorFunction:null})}function integerReadValueFromPointer(r,t,n){switch(t){case 0:return n?function(s){return HEAP8[s]}:function(s){return HEAPU8[s]};case 1:return n?function(s){return HEAP16[s>>1]}:function(s){return HEAPU16[s>>1]};case 2:return n?function(s){return HEAP32[s>>2]}:function(s){return HEAPU32[s>>2]};default:throw new TypeError("Unknown integer type: "+r)}}function __embind_register_integer(r,t,n,i,s){t=readLatin1String(t);var o=getShiftFromSize(n),u=h=>h;if(i===0){var l=32-8*n;u=h=>h<<l>>>l}var g=t.includes("unsigned"),f=(h,m)=>{},p;g?p=function(h,m){return f(m,this.name),m>>>0}:p=function(h,m){return f(m,this.name),m},registerType(r,{name:t,fromWireType:u,toWireType:p,argPackAdvance:8,readValueFromPointer:integerReadValueFromPointer(t,o,i!==0),destructorFunction:null})}function __embind_register_memory_view(r,t,n){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],s=i[t];function o(u){u=u>>2;var l=HEAPU32,g=l[u],f=l[u+1];return new s(l.buffer,f,g)}n=readLatin1String(n),registerType(r,{name:n,fromWireType:o,argPackAdvance:8,readValueFromPointer:o},{ignoreDuplicateRegistrations:!0})}function lengthBytesUTF8(r){for(var t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++n):t+=3}return t}function __embind_register_std_string(r,t){t=readLatin1String(t);var n=t==="std::string";registerType(r,{name:t,fromWireType:function(i){var s=HEAPU32[i>>2],o=i+4,u;if(n)for(var l=o,g=0;g<=s;++g){var f=o+g;if(g==s||HEAPU8[f]==0){var p=f-l,h=UTF8ToString(l,p);u===void 0?u=h:(u+=String.fromCharCode(0),u+=h),l=f+1}}else{for(var m=new Array(s),g=0;g<s;++g)m[g]=String.fromCharCode(HEAPU8[o+g]);u=m.join("")}return _free(i),u},toWireType:function(i,s){s instanceof ArrayBuffer&&(s=new Uint8Array(s));var o,u=typeof s=="string";u||s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Int8Array||throwBindingError("Cannot pass non-string to std::string"),n&&u?o=lengthBytesUTF8(s):o=s.length;var l=_malloc(4+o+1),g=l+4;if(HEAPU32[l>>2]=o,n&&u)stringToUTF8(s,g,o+1);else if(u)for(var f=0;f<o;++f){var p=s.charCodeAt(f);p>255&&(_free(g),throwBindingError("String has UTF-16 code units that do not fit in 8 bits")),HEAPU8[g+f]=p}else for(var f=0;f<o;++f)HEAPU8[g+f]=s[f];return i!==null&&i.push(_free,l),l},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:function(i){_free(i)}})}var UTF16Decoder=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function UTF16ToString(r,t){for(var n=r,i=n>>1,s=i+t/2;!(i>=s)&&HEAPU16[i];)++i;if(n=i<<1,n-r>32&&UTF16Decoder)return UTF16Decoder.decode(HEAPU8.subarray(r,n));for(var o="",u=0;!(u>=t/2);++u){var l=HEAP16[r+u*2>>1];if(l==0)break;o+=String.fromCharCode(l)}return o}function stringToUTF16(r,t,n){if(n===void 0&&(n=2147483647),n<2)return 0;n-=2;for(var i=t,s=n<r.length*2?n/2:r.length,o=0;o<s;++o){var u=r.charCodeAt(o);HEAP16[t>>1]=u,t+=2}return HEAP16[t>>1]=0,t-i}function lengthBytesUTF16(r){return r.length*2}function UTF32ToString(r,t){for(var n=0,i="";!(n>=t/4);){var s=HEAP32[r+n*4>>2];if(s==0)break;if(++n,s>=65536){var o=s-65536;i+=String.fromCharCode(55296|o>>10,56320|o&1023)}else i+=String.fromCharCode(s)}return i}function stringToUTF32(r,t,n){if(n===void 0&&(n=2147483647),n<4)return 0;for(var i=t,s=i+n-4,o=0;o<r.length;++o){var u=r.charCodeAt(o);if(u>=55296&&u<=57343){var l=r.charCodeAt(++o);u=65536+((u&1023)<<10)|l&1023}if(HEAP32[t>>2]=u,t+=4,t+4>s)break}return HEAP32[t>>2]=0,t-i}function lengthBytesUTF32(r){for(var t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=55296&&i<=57343&&++n,t+=4}return t}function __embind_register_std_wstring(r,t,n){n=readLatin1String(n);var i,s,o,u,l;t===2?(i=UTF16ToString,s=stringToUTF16,u=lengthBytesUTF16,o=()=>HEAPU16,l=1):t===4&&(i=UTF32ToString,s=stringToUTF32,u=lengthBytesUTF32,o=()=>HEAPU32,l=2),registerType(r,{name:n,fromWireType:function(g){for(var f=HEAPU32[g>>2],p=o(),h,m=g+4,y=0;y<=f;++y){var v=g+4+y*t;if(y==f||p[v>>l]==0){var w=v-m,_=i(m,w);h===void 0?h=_:(h+=String.fromCharCode(0),h+=_),m=v+t}}return _free(g),h},toWireType:function(g,f){typeof f!="string"&&throwBindingError("Cannot pass non-string to C++ string type "+n);var p=u(f),h=_malloc(4+p+t);return HEAPU32[h>>2]=p>>l,s(f,h+4,p+t),g!==null&&g.push(_free,h),h},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:function(g){_free(g)}})}function __embind_register_void(r,t){t=readLatin1String(t),registerType(r,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(n,i){}})}function __emscripten_throw_longjmp(){throw 1/0}function __mmap_js(r,t,n,i,s,o,u){return-52}function __munmap_js(r,t,n,i,s,o){}function _abort(){abort("")}var _emscripten_get_now;typeof performance<"u"&&performance.now?_emscripten_get_now=()=>performance.now():_emscripten_get_now=Date.now;var _emscripten_memcpy_big=Uint8Array.prototype.copyWithin?(r,t,n)=>HEAPU8.copyWithin(r,t,t+n):(r,t,n)=>HEAPU8.set(HEAPU8.subarray(t,t+n),r);function getHeapMax(){return 2147483648}function emscripten_realloc_buffer(r){var t=wasmMemory.buffer;try{return wasmMemory.grow(r-t.byteLength+65535>>>16),updateMemoryViews(),1}catch{}}function _emscripten_resize_heap(r){var t=HEAPU8.length;r=r>>>0;var n=getHeapMax();if(r>n)return!1;for(var i=(g,f)=>g+(f-g%f)%f,s=1;s<=4;s*=2){var o=t*(1+.2/s);o=Math.min(o,r+100663296);var u=Math.min(n,i(Math.max(r,o),65536)),l=emscripten_realloc_buffer(u);if(l)return!0}return!1}var ENV={};function getExecutableName(){return"./this.program"}function getEnvStrings(){if(!getEnvStrings.strings){var r=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:r,_:getExecutableName()};for(var n in ENV)ENV[n]===void 0?delete t[n]:t[n]=ENV[n];var i=[];for(var n in t)i.push(n+"="+t[n]);getEnvStrings.strings=i}return getEnvStrings.strings}function stringToAscii(r,t){for(var n=0;n<r.length;++n)HEAP8[t++>>0]=r.charCodeAt(n);HEAP8[t>>0]=0}function _environ_get(r,t){var n=0;return getEnvStrings().forEach(function(i,s){var o=t+n;HEAPU32[r+s*4>>2]=o,stringToAscii(i,o),n+=i.length+1}),0}function _environ_sizes_get(r,t){var n=getEnvStrings();HEAPU32[r>>2]=n.length;var i=0;return n.forEach(function(s){i+=s.length+1}),HEAPU32[t>>2]=i,0}function _proc_exit(r){throw"exit("+r+")"}var _exit=_proc_exit;function _fd_close(r){return 52}function _fd_read(r,t,n,i){return 52}function _fd_seek(r,t,n,i,s){return 70}var printCharBuffers=[null,[],[]];function printChar(r,t){var n=printCharBuffers[r];t===0||t===10?((r===1?out:err)(UTF8ArrayToString(n,0)),n.length=0):n.push(t)}function _fd_write(r,t,n,i){for(var s=0,o=0;o<n;o++){var u=HEAPU32[t>>2],l=HEAPU32[t+4>>2];t+=8;for(var g=0;g<l;g++)printChar(r,HEAPU8[u+g]);s+=l}return HEAPU32[i>>2]=s,0}embind_init_charCodes();BindingError=Module.BindingError=extendError(Error,"BindingError");InternalError=Module.InternalError=extendError(Error,"InternalError");init_ClassHandle();init_embind();init_RegisteredPointer();UnboundTypeError=Module.UnboundTypeError=extendError(Error,"UnboundTypeError");init_emval();var wasmImports={b:___assert_fail,k:___syscall_fcntl64,I:___syscall_fstat64,A:___syscall_getdents64,L:___syscall_ioctl,G:___syscall_newfstatat,n:___syscall_openat,H:___syscall_stat64,u:__embind_register_bigint,r:__embind_register_bool,j:__embind_register_class,B:__embind_register_class_constructor,d:__embind_register_class_function,c:__embind_register_class_property,M:__embind_register_emval,p:__embind_register_float,g:__embind_register_integer,e:__embind_register_memory_view,q:__embind_register_std_string,l:__embind_register_std_wstring,s:__embind_register_void,y:__emscripten_throw_longjmp,C:__mmap_js,D:__munmap_js,f:_abort,m:_emscripten_get_now,J:_emscripten_memcpy_big,z:_emscripten_resize_heap,E:_environ_get,F:_environ_sizes_get,h:_exit,i:_fd_close,o:_fd_read,t:_fd_seek,K:_fd_write,x:invoke_iii,v:invoke_iiii,w:invoke_iiiii,a:wasmMemory};function invoke_iii(r,t,n){var i=stackSave();try{return getWasmTableEntry(r)(t,n)}catch(s){if(stackRestore(i),s!==s+0)throw s;_setThrew(1,0)}}function invoke_iiiii(r,t,n,i,s){var o=stackSave();try{return getWasmTableEntry(r)(t,n,i,s)}catch(u){if(stackRestore(o),u!==u+0)throw u;_setThrew(1,0)}}function invoke_iiii(r,t,n,i){var s=stackSave();try{return getWasmTableEntry(r)(t,n,i)}catch(o){if(stackRestore(s),o!==o+0)throw o;_setThrew(1,0)}}function initRuntime(r){r.N()}var imports={a:wasmImports},_malloc,_free,___getTypeName,_setThrew,stackSave,stackRestore;(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(fetch("jassub-worker.wasm"),imports):WebAssembly.instantiate(Module.wasm,imports)).then(function(r){asm=(r.instance||r).exports,_malloc=asm.O,_free=asm.P,___getTypeName=asm.Q,asm.R,_setThrew=asm.T,asm.U,asm.V,stackSave=asm.W,stackRestore=asm.X,asm.Y,asm.Z,asm._,asm.$,wasmTable=asm.S,initRuntime(asm),ready()},function(r){var t=location.search;t.indexOf("_rwasm=0")<0&&(location.href+=(t?t+"&":"?")+"_rwasm=0")});
