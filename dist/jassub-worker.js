var v=v,Ge=e=>console.log(e),Xe=e=>console.error(e);function qe(){}self.assert||(self.assert=(e,t)=>{if(!e)throw t});String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t===void 0&&(t=0),this.substring(t,e.length)===e});String.prototype.includes||(String.prototype.includes=function(e,t){return this.indexOf(e,t)!==-1});if(!ArrayBuffer.isView){const e=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];ArrayBuffer.isView=t=>t&&t.constructor&&e.indexOf(t.constructor)!==-1}Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){return new Uint8Array(this.subarray(e,t))});Date.now||(Date.now=()=>new Date().getTime());"performance"in self||(self.performance={now:()=>Date.now()});if(typeof console>"u"){const e=(t,r)=>{postMessage({target:"console",command:t,content:JSON.stringify(Array.prototype.slice.call(r))})};console={log:function(){e("log",arguments)},debug:function(){e("debug",arguments)},info:function(){e("info",arguments)},warn:function(){e("warn",arguments)},error:function(){e("error",arguments)}},console.log("Detected lack of console, overridden console")}const Te=(e,t)=>{const r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType=t?"arraybuffer":"text",r.send(null),r.response},Tt=(e,t,r)=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{if((n.status===200||n.status===0)&&n.response)return t(n.response);r()},n.onerror=r,n.send(null)};v={wasm:WebAssembly&&!WebAssembly.instantiateStreaming&&Te("jassub-worker.wasm",!0)};qe=()=>postMessage({target:"ready"});Ge=e=>{e==="JASSUB: No usable fontconfig configuration file found, using fallback."?console.debug(e):console.log(e)};Xe=e=>{e==="Fontconfig error: Cannot load default config file: No such file: (null)"?console.debug(e):console.error(e)};let X=0;const Pt=1;let E=null,Le=!1,Pe=Date.now(),ie=24,Ye=!1,Ke="js",oe={};const He={};let St=0,Qe;self.width=0;self.height=0;let D=!1;self.addFont=({font:e})=>Se(e);const _e=e=>{e=e.trim().toLowerCase(),e.startsWith("@")&&(e=e.substring(1)),!He[e]&&(He[e]=!0,oe[e]?Se(oe[e]):Ye&&postMessage({target:"getLocalFont",font:e}))},Se=e=>{ArrayBuffer.isView(e)?Be(e):Tt(e,t=>{Be(new Uint8Array(t))},console.error)},Be=e=>{const t=he(e.byteLength);C.set(e,t),h.addFont("font-"+St++,t,e.byteLength),h.reloadFonts()},Ze=e=>{if(!oe)return;const t=kt(e);for(let i=0;i<t.length;i++)for(let a=0;a<t[i].body.length;a++)t[i].body[a].key==="Style"&&_e(t[i].body[a].value.Fontname);const r=/\\fn([^\\}]*?)[\\}]/g;let n;for(;(n=r.exec(e))!==null;)_e(n[1])};self.setTrack=({content:e})=>{Ze(e),h.createTrackMem(e),ke=et[h.trackColorSpace]};self.freeTrack=()=>{h.removeTrack()};self.setTrackByUrl=({url:e})=>{self.setTrack({content:Te(e)})};const Ft=()=>{const e=(Date.now()-Pe)/1e3;return se?X:(e>5&&(console.error("Didn't received currentTime > 5 seconds. Assuming video was paused."),Ne(!0)),X+e*Pt)},At=e=>{X=e,Pe=Date.now(),E||(Le?E=Ae(ae):(ae(),setTimeout(()=>{Le=!1},20)))};let se=!0;const Ne=e=>{e!==se&&(se=e,e?E&&(clearTimeout(E),E=null):(Pe=Date.now(),E=Ae(ae)))},V="BT.601",Ve="BT.709",xe="SMPTE240M",et=[V,V,V,V,V,Ve,Ve,xe,xe,"FCC","FCC"],Fe=(e,t)=>{const r=performance.now(),n=Ke==="wasm"?h.renderBlend(e,t||0):h.renderImage(e,t||0),i={renderTime:performance.now()-r-h.time,decodeTime:h.time};if(h.changed!==0||t){const a=[];let o=[];const s=performance.now();if(!n)return be({images:a,buffers:o,times:i,decodeStartTime:s});if(D){const f=[];for(let l=n,u=0;u<h.count;l=l.next,++u)a.push({w:l.w,h:l.h,x:l.x,y:l.y}),f.push(createImageBitmap(new ImageData(Ee.slice(l.image,l.image+l.w*l.h*4),l.w,l.h)));Promise.all(f).then(l=>{for(let u=0;u<a.length;u++)a[u].image=l[u];o=l,be({images:a,buffers:o,times:i,decodeStartTime:s})})}else{for(let f=n,l=0;l<h.count;f=f.next,++l){const u={w:f.w,h:f.h,x:f.x,y:f.y,image:f.image};if(!I){const c=B.buffer.slice(f.image,f.image+f.w*f.h*4);o.push(c),u.image=c}a.push(u)}be({images:a,buffers:o,times:i,decodeStartTime:s})}}else postMessage({target:"unbusy"})};self.demand=({time:e})=>{X=e,Fe(e)};const ae=e=>{E=0,Fe(Ft(),e),se||(E=Ae(ae))},be=({times:e,images:t,decodeStartTime:r,buffers:n})=>{e.decodeTime=performance.now()-r;const i={target:"render",async:D,images:t,times:e,width:self.width,height:self.height,colorSpace:ke};if(I){const a=performance.now();(M.height!==self.height||M.width!==self.width)&&(M.width=self.width,M.height=self.height),I.clearRect(0,0,self.width,self.height);for(const o of t)o.image&&(D?(I.drawImage(o.image,o.x,o.y),o.image.close()):(x.width=o.w,x.height=o.h,tt.putImageData(new ImageData(Ee.subarray(o.image,o.image+o.w*o.h*4),o.w,o.h),0,0),I.drawImage(x,o.x,o.y)));if(Qe){e.drawTime=performance.now()-a;let o=0;for(const s in e)o+=e[s];console.log("Bitmaps: "+t.length+" Total: "+Math.round(o)+"ms",e)}try{const o=M.transferToImageBitmap();i.images=[{image:o,x:0,y:0}],i.async=!0,postMessage(i,[o])}catch{postMessage({target:"unbusy"})}}else postMessage(i,n)},kt=e=>{let t,r,n,i,a,o,s,f,l,u;const c=[],d=e.split(/[\r\n]+/g);for(f=0;f<d.length;f++)if(t=d[f].match(/^\[(.*)\]$/),t)r=null,c.push({name:t[1],body:[]});else{if(/^\s*$/.test(d[f])||c.length===0)continue;if(u=c[c.length-1].body,d[f][0]===";")u.push({type:"comment",value:d[f].substring(1)});else{if(i=d[f].split(":"),a=i[0],o=i.slice(1).join(":").trim(),(r||a==="Format")&&(o=o.split(","),r&&o.length>r.length&&(n=o.slice(r.length-1).join(","),o=o.slice(0,r.length-1),o.push(n)),o=o.map(p=>p.trim()),r)){for(s={},l=0;l<o.length;l++)s[r[l]]=o[l];o=s}a==="Format"&&(r=o),u.push({key:a,value:o})}}return c},Ae=(()=>{let e=0;return t=>{const r=Date.now();if(e===0)e=r+1e3/ie;else for(;r+2>=e;)e+=1e3/ie;const n=Math.max(e-r,0);return setTimeout(t,n)}})(),ce=(e,t)=>{for(const r of Object.keys(e))t[r]=e[r]};let M,I,x,tt,h,ke;self.init=e=>{self.width=e.width,self.height=e.height,Ke=e.blendMode,D=e.asyncRender,D&&typeof createImageBitmap>"u"&&(D=!1,console.error("'createImageBitmap' needed for 'asyncRender' unsupported!")),oe=e.availableFonts,Qe=e.debug,ie=e.targetFps||ie,Ye=e.useLocalFonts;const t=e.fallbackFont.toLowerCase();h=new v.JASSUB(self.width,self.height,t||null),t&&_e(t);let r=e.subContent;r||(r=Te(e.subUrl)),Ze(r);for(const n of e.fonts||[])Se(n);h.createTrackMem(r),ke=et[h.trackColorSpace],h.setDropAnimations(e.dropAllAnimations||0),(e.libassMemoryLimit>0||e.libassGlyphLimit>0)&&h.setMemoryLimits(e.libassGlyphLimit||0,e.libassMemoryLimit||0),e.offscreenRender&&(M=new OffscreenCanvas(self.height,self.width),I=M.getContext("2d",{desynchronized:!0}),D||(x=new OffscreenCanvas(self.height,self.width),tt=x.getContext("2d",{desynchronized:!0})))};self.canvas=({width:e,height:t,force:r})=>{if(e==null)throw new Error("Invalid canvas size specified");self.width=e,self.height=t,h.resizeCanvas(e,t),r&&Fe(X)};self.video=({currentTime:e,isPaused:t,rate:r})=>{e!=null&&At(e),t!=null&&Ne(t),r=r||r};self.destroy=()=>{h.quitLibrary()};self.createEvent=({event:e})=>{ce(e,h.getEvent(h.allocEvent()))};self.getEvents=()=>{const e=[];for(let t=0;t<h.getEventCount();t++){const{Start:r,Duration:n,ReadOrder:i,Layer:a,Style:o,MarginL:s,MarginR:f,MarginV:l,Name:u,Text:c,Effect:d}=h.getEvent(t);e.push({Start:r,Duration:n,ReadOrder:i,Layer:a,Style:o,MarginL:s,MarginR:f,MarginV:l,Name:u,Text:c,Effect:d})}postMessage({target:"getEvents",events:e})};self.setEvent=({event:e,index:t})=>{ce(e,h.getEvent(t))};self.removeEvent=({index:e})=>{h.removeEvent(e)};self.createStyle=({style:e})=>{ce(e,h.getStyle(h.allocStyle()))};self.getStyles=()=>{const e=[];for(let t=0;t<h.getStyleCount();t++){const{Name:r,FontName:n,FontSize:i,PrimaryColour:a,SecondaryColour:o,OutlineColour:s,BackColour:f,Bold:l,Italic:u,Underline:c,StrikeOut:d,ScaleX:p,ScaleY:y,Spacing:w,Angle:m,BorderStyle:_,Outline:U,Shadow:b,Alignment:we,MarginL:Z,MarginR:N,MarginV:ee,Encoding:bt,treat_fontname_as_pattern:Ct,Blur:_t,Justify:$t}=h.getStyle(t);e.push({Name:r,FontName:n,FontSize:i,PrimaryColour:a,SecondaryColour:o,OutlineColour:s,BackColour:f,Bold:l,Italic:u,Underline:c,StrikeOut:d,ScaleX:p,ScaleY:y,Spacing:w,Angle:m,BorderStyle:_,Outline:U,Shadow:b,Alignment:we,MarginL:Z,MarginR:N,MarginV:ee,Encoding:bt,treat_fontname_as_pattern:Ct,Blur:_t,Justify:$t})}postMessage({target:"getStyles",time:Date.now(),styles:e})};self.setStyle=({style:e,index:t})=>{ce(e,h.getStyle(t))};self.removeStyle=({index:e})=>{h.removeStyle(e)};onmessage=({data:e})=>{if(self[e.target])self[e.target](e);else throw new Error("Unknown event target "+e.target)};let Ee=null;le=(e=>()=>{e(),Ee=new Uint8ClampedArray(B.buffer)})(le);function rt(e){throw e}var Oe,q,W,C,de,T,nt,it,B,ot;function le(){var e=B.buffer;Oe=new Int8Array(e),q=new Int16Array(e),W=new Int32Array(e),C=new Uint8Array(e),de=new Uint16Array(e),T=new Uint32Array(e),nt=new Float32Array(e),it=new Float64Array(e)}var st=new TextDecoder("utf8");function ne(e,t){if(!e)return"";for(var r=e+t,n=e;!(n>=r)&&C[n];)++n;return st.decode(C.subarray(e,n))}function Et(e,t,r,n){rt(`Assertion failed: ${ne(e)}, at: `+[t?ne(t):"unknown filename",r,n?ne(n):"unknown function"])}function Ot(e,t,r){return 0}function Ut(e,t,r,n){if(!(n>0))return 0;for(var i=r,a=r+n-1,o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343){var f=e.charCodeAt(++o);s=65536+((s&1023)<<10)|f&1023}if(s<=127){if(r>=a)break;t[r++]=s}else if(s<=2047){if(r+1>=a)break;t[r++]=192|s>>6,t[r++]=128|s&63}else if(s<=65535){if(r+2>=a)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|s&63}else{if(r+3>=a)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|s&63}}return t[r]=0,r-i}function Mt(e,t,r){return Ut(e,C,t,r)}function Dt(e,t,r){}function Wt(e,t,r){return 0}function Rt(e,t,r,n){}function It(e,t,r,n,i){}function Ue(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function jt(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);at=e}var at=void 0;function $(e){for(var t="",r=e;C[r];)t+=at[C[r++]];return t}var j={},L={},fe={},Lt=48,Ht=57;function Me(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=Lt&&t<=Ht?"_"+e:e}function De(e,t){return e=Me(e),{[e]:function(){return t.apply(this,arguments)}}[e]}function We(e,t){var r=De(t,function(n){this.name=t,this.message=n;var i=new Error(n).stack;i!==void 0&&(this.stack=this.toString()+`
`+i.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var H=void 0;function g(e){throw new H(e)}var lt=void 0;function ue(e){throw new lt(e)}function R(e,t,r){e.forEach(function(s){fe[s]=t});function n(s){var f=r(s);f.length!==e.length&&ue("Mismatched type converter count");for(var l=0;l<e.length;++l)A(e[l],f[l])}var i=new Array(t.length),a=[],o=0;t.forEach((s,f)=>{L.hasOwnProperty(s)?i[f]=L[s]:(a.push(s),j.hasOwnProperty(s)||(j[s]=[]),j[s].push(()=>{i[f]=L[s],++o,o===a.length&&n(i)}))}),a.length===0&&n(i)}function A(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=t.name;if(e||g(`type "${n}" must have a positive integer typeid pointer`),L.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;g(`Cannot register type '${n}' twice`)}if(L[e]=t,delete fe[e],j.hasOwnProperty(e)){var i=j[e];delete j[e],i.forEach(a=>a())}}function Bt(e,t,r,n,i){var a=Ue(r);t=$(t),A(e,{name:t,fromWireType:function(o){return!!o},toWireType:function(o,s){return s?n:i},argPackAdvance:8,readValueFromPointer:function(o){var s;if(r===1)s=Oe;else if(r===2)s=q;else if(r===4)s=W;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(s[o>>a])},destructorFunction:null})}function Vt(e){if(!(this instanceof k)||!(e instanceof k))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=e.$$.ptrType.registeredClass,i=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)i=n.upcast(i),n=n.baseClass;return t===n&&r===i}function xt(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Re(e){function t(r){return r.$$.ptrType.registeredClass.name}g(t(e)+" instance already deleted")}var Ce=!1;function ft(e){}function zt(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function ut(e){e.count.value-=1;var t=e.count.value===0;t&&zt(e)}function ct(e,t,r){if(t===r)return e;if(r.baseClass===void 0)return null;var n=ct(e,t,r.baseClass);return n===null?null:r.downcast(n)}var dt={};function Jt(){return Object.keys(J).length}function Gt(){var e=[];for(var t in J)J.hasOwnProperty(t)&&e.push(J[t]);return e}var Y=[];function Ie(){for(;Y.length;){var e=Y.pop();e.$$.deleteScheduled=!1,e.delete()}}var z=void 0;function Xt(e){z=e,Y.length&&z&&z(Ie)}function qt(){v.getInheritedInstanceCount=Jt,v.getLiveInheritedInstances=Gt,v.flushPendingDeletes=Ie,v.setDelayFunction=Xt}var J={};function Yt(e,t){for(t===void 0&&g("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function Kt(e,t){return t=Yt(e,t),J[t]}function te(e,t){(!t.ptrType||!t.ptr)&&ue("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,n=!!t.smartPtr;return r!==n&&ue("Both smartPtrType and smartPtr must be specified"),t.count={value:1},G(Object.create(e,{$$:{value:t}}))}function Qt(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=Kt(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function i(){return this.isSmartPointer?te(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):te(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var a=this.registeredClass.getActualType(t),o=dt[a];if(!o)return i.call(this);var s;this.isConst?s=o.constPointerType:s=o.pointerType;var f=ct(t,this.registeredClass,s.registeredClass);return f===null?i.call(this):this.isSmartPointer?te(s.registeredClass.instancePrototype,{ptrType:s,ptr:f,smartPtrType:this,smartPtr:e}):te(s.registeredClass.instancePrototype,{ptrType:s,ptr:f})}function G(e){return typeof FinalizationRegistry>"u"?(G=t=>t,e):(Ce=new FinalizationRegistry(t=>{ut(t.$$)}),G=t=>{var r=t.$$,n=!!r.smartPtr;if(n){var i={$$:r};Ce.register(t,i,t)}return t},ft=t=>Ce.unregister(t),G(e))}function Zt(){if(this.$$.ptr||Re(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=G(Object.create(Object.getPrototypeOf(this),{$$:{value:xt(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function Nt(){this.$$.ptr||Re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&g("Object already scheduled for deletion"),ft(this),ut(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function er(){return!this.$$.ptr}function tr(){return this.$$.ptr||Re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&g("Object already scheduled for deletion"),Y.push(this),Y.length===1&&z&&z(Ie),this.$$.deleteScheduled=!0,this}function rr(){k.prototype.isAliasOf=Vt,k.prototype.clone=Zt,k.prototype.delete=Nt,k.prototype.isDeleted=er,k.prototype.deleteLater=tr}function k(){}function gt(e,t,r){if(e[t].overloadTable===void 0){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||g(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}}function nr(e,t,r){v.hasOwnProperty(e)?((r===void 0||v[e].overloadTable!==void 0&&v[e].overloadTable[r]!==void 0)&&g(`Cannot register public name '${e}' twice`),gt(v,e,e),v.hasOwnProperty(r)&&g(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),v[e].overloadTable[r]=t):(v[e]=t,r!==void 0&&(v[e].numArguments=r))}function ir(e,t,r,n,i,a,o,s){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=i,this.getActualType=a,this.upcast=o,this.downcast=s,this.pureVirtualFunctions=[]}function ge(e,t,r){for(;t!==r;)t.upcast||g(`Expected null or instance of ${r.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e}function or(e,t){if(t===null)return this.isReference&&g("null is not a valid "+this.name),0;t.$$||g(`Cannot pass "${je(t)}" as a ${this.name}`),t.$$.ptr||g("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass,n=ge(t.$$.ptr,r,this.registeredClass);return n}function sr(e,t){var r;if(t===null)return this.isReference&&g("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;t.$$||g(`Cannot pass "${je(t)}" as a ${this.name}`),t.$$.ptr||g(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&g(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var n=t.$$.ptrType.registeredClass;if(r=ge(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&g("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:g(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var i=t.clone();r=this.rawShare(r,$e.toHandle(function(){i.delete()})),e!==null&&e.push(this.rawDestructor,r)}break;default:g("Unsupporting sharing policy")}return r}function ar(e,t){if(t===null)return this.isReference&&g("null is not a valid "+this.name),0;t.$$||g(`Cannot pass "${je(t)}" as a ${this.name}`),t.$$.ptr||g(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&g(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var r=t.$$.ptrType.registeredClass,n=ge(t.$$.ptr,r,this.registeredClass);return n}function pe(e){return this.fromWireType(W[e>>2])}function lr(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function fr(e){this.rawDestructor&&this.rawDestructor(e)}function ur(e){e!==null&&e.delete()}function cr(){S.prototype.getPointee=lr,S.prototype.destructor=fr,S.prototype.argPackAdvance=8,S.prototype.readValueFromPointer=pe,S.prototype.deleteObject=ur,S.prototype.fromWireType=Qt}function S(e,t,r,n,i,a,o,s,f,l,u){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=i,this.pointeeType=a,this.sharingPolicy=o,this.rawGetPointee=s,this.rawConstructor=f,this.rawShare=l,this.rawDestructor=u,!i&&t.baseClass===void 0?n?(this.toWireType=or,this.destructorFunction=null):(this.toWireType=ar,this.destructorFunction=null):this.toWireType=sr}function dr(e,t,r){v.hasOwnProperty(e)||ue("Replacing nonexistant public symbol"),v[e].overloadTable!==void 0&&r!==void 0?v[e].overloadTable[r]=t:(v[e]=t,v[e].argCount=r)}function gr(e,t,r){var n=dynCalls[e];return r&&r.length?n.apply(null,[t].concat(r)):n.call(null,t)}var re=[];function Q(e){var t=re[e];return t||(e>=re.length&&(re.length=e+1),re[e]=t=ot.get(e)),t}function pr(e,t,r){if(e.includes("j"))return gr(e,t,r);var n=Q(t).apply(null,r);return n}function hr(e,t){var r=[];return function(){return r.length=0,Object.assign(r,arguments),pr(e,t,r)}}function O(e,t){e=$(e);function r(){return e.includes("j")?hr(e,t):Q(t)}var n=r();return typeof n!="function"&&g(`unknown function pointer with signature ${e}: ${t}`),n}var pt=void 0;function vr(e){var t=wt(e),r=$(t);return F(t),r}function K(e,t){var r=[],n={};function i(a){if(!n[a]&&!L[a]){if(fe[a]){fe[a].forEach(i);return}r.push(a),n[a]=!0}}throw t.forEach(i),new pt(e+": "+r.map(vr).join([", "]))}function yr(e,t,r,n,i,a,o,s,f,l,u,c,d){u=$(u),a=O(i,a),s&&(s=O(o,s)),l&&(l=O(f,l)),d=O(c,d);var p=Me(u);nr(p,function(){K(`Cannot construct ${u} due to unbound types`,[n])}),R([e,t,r],n?[n]:[],function(y){y=y[0];var w,m;n?(w=y.registeredClass,m=w.instancePrototype):m=k.prototype;var _=De(p,function(){if(Object.getPrototypeOf(this)!==U)throw new H("Use 'new' to construct "+u);if(b.constructor_body===void 0)throw new H(u+" has no accessible constructor");var ee=b.constructor_body[arguments.length];if(ee===void 0)throw new H(`Tried to invoke ctor of ${u} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(b.constructor_body).toString()}) parameters instead!`);return ee.apply(this,arguments)}),U=Object.create(m,{constructor:{value:_}});_.prototype=U;var b=new ir(u,_,U,d,w,a,s,l);b.baseClass&&(b.baseClass.__derivedClasses===void 0&&(b.baseClass.__derivedClasses=[]),b.baseClass.__derivedClasses.push(b));var we=new S(u,b,!0,!1,!1),Z=new S(u+"*",b,!1,!1,!1),N=new S(u+" const*",b,!1,!0,!1);return dt[e]={pointerType:Z,constPointerType:N},dr(p,_),[we,Z,N]})}function ht(e,t){for(var r=[],n=0;n<e;n++)r.push(T[t+n*4>>2]);return r}function vt(e){for(;e.length;){var t=e.pop(),r=e.pop();r(t)}}function mr(e,t){if(!(e instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof e} which is not a function`);var r=De(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var n=new r,i=e.apply(n,t);return i instanceof Object?i:n}function yt(e,t,r,n,i,a){var o=t.length;o<2&&g("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=t[1]!==null&&r!==null,f=!1,l=1;l<t.length;++l)if(t[l]!==null&&t[l].destructorFunction===void 0){f=!0;break}for(var u=t[0].name!=="void",c="",d="",l=0;l<o-2;++l)c+=(l!==0?", ":"")+"arg"+l,d+=(l!==0?", ":"")+"arg"+l+"Wired";var p="return function "+Me(e)+"("+c+`) {
if (arguments.length !== `+(o-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+` args!');
}
`;f&&(p+=`var destructors = [];
`);var y=f?"destructors":"null",w=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],m=[g,n,i,vt,t[0],t[1]];s&&(p+="var thisWired = classParam.toWireType("+y+`, this);
`);for(var l=0;l<o-2;++l)p+="var arg"+l+"Wired = argType"+l+".toWireType("+y+", arg"+l+"); // "+t[l+2].name+`
`,w.push("argType"+l),m.push(t[l+2]);if(s&&(d="thisWired"+(d.length>0?", ":"")+d),p+=(u||a?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+`);
`,f)p+=`runDestructors(destructors);
`;else for(var l=s?1:2;l<t.length;++l){var _=l===1?"thisWired":"arg"+(l-2)+"Wired";t[l].destructorFunction!==null&&(p+=_+"_dtor("+_+"); // "+t[l].name+`
`,w.push(_+"_dtor"),m.push(t[l].destructorFunction))}return u&&(p+=`var ret = retType.fromWireType(rv);
return ret;
`),p+=`}
`,w.push(p),mr(Function,w).apply(null,m)}function wr(e,t,r,n,i,a){assert(t>0);var o=ht(t,r);i=O(n,i),R([],[e],function(s){s=s[0];var f="constructor "+s.name;if(s.registeredClass.constructor_body===void 0&&(s.registeredClass.constructor_body=[]),s.registeredClass.constructor_body[t-1]!==void 0)throw new H(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${s.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return s.registeredClass.constructor_body[t-1]=()=>{K(`Cannot construct ${s.name} due to unbound types`,o)},R([],o,function(l){return l.splice(1,0,null),s.registeredClass.constructor_body[t-1]=yt(f,l,null,i,a),[]}),[]})}function br(e,t,r,n,i,a,o,s,f){var l=ht(r,n);t=$(t),a=O(i,a),R([],[e],function(u){u=u[0];var c=u.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),s&&u.registeredClass.pureVirtualFunctions.push(t);function d(){K(`Cannot call ${c} due to unbound types`,l)}var p=u.registeredClass.instancePrototype,y=p[t];return y===void 0||y.overloadTable===void 0&&y.className!==u.name&&y.argCount===r-2?(d.argCount=r-2,d.className=u.name,p[t]=d):(gt(p,t,c),p[t].overloadTable[r-2]=d),R([],l,function(w){var m=yt(c,w,u,a,o,f);return p[t].overloadTable===void 0?(m.argCount=r-2,p[t]=m):p[t].overloadTable[r-2]=m,[]}),[]})}function ze(e,t,r){return e instanceof Object||g(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||g(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||g(`cannot call emscripten binding method ${r} on deleted object`),ge(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}function Cr(e,t,r,n,i,a,o,s,f,l){t=$(t),i=O(n,i),R([],[e],function(u){u=u[0];var c=u.name+"."+t,d={get:function(){K(`Cannot access ${c} due to unbound types`,[r,o])},enumerable:!0,configurable:!0};return f?d.set=()=>{K(`Cannot access ${c} due to unbound types`,[r,o])}:d.set=p=>{g(c+" is a read-only property")},Object.defineProperty(u.registeredClass.instancePrototype,t,d),R([],f?[r,o]:[r],function(p){var y=p[0],w={get:function(){var _=ze(this,u,c+" getter");return y.fromWireType(i(a,_))},enumerable:!0};if(f){f=O(s,f);var m=p[1];w.set=function(_){var U=ze(this,u,c+" setter"),b=[];f(l,U,m.toWireType(b,_)),vt(b)}}return Object.defineProperty(u.registeredClass.instancePrototype,t,w),[]}),[]})}function _r(){this.allocated=[void 0],this.freelist=[],this.get=function(e){return this.allocated[e]},this.allocate=function(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},this.free=function(e){this.allocated[e]=void 0,this.freelist.push(e)}}var P=new _r;function $r(e){e>=P.reserved&&--P.get(e).refcount===0&&P.free(e)}function Tr(){for(var e=0,t=P.reserved;t<P.allocated.length;++t)P.allocated[t]!==void 0&&++e;return e}function Pr(){P.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),P.reserved=P.allocated.length,v.count_emval_handles=Tr}var $e={toValue:e=>(e||g("Cannot use deleted val. handle = "+e),P.get(e).value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return P.allocate({refcount:1,value:e})}}};function Sr(e,t){t=$(t),A(e,{name:t,fromWireType:function(r){var n=$e.toValue(r);return $r(r),n},toWireType:function(r,n){return $e.toHandle(n)},argPackAdvance:8,readValueFromPointer:pe,destructorFunction:null})}function je(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function Fr(e,t){switch(t){case 2:return function(r){return this.fromWireType(nt[r>>2])};case 3:return function(r){return this.fromWireType(it[r>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Ar(e,t,r){var n=Ue(r);t=$(t),A(e,{name:t,fromWireType:function(i){return i},toWireType:function(i,a){return a},argPackAdvance:8,readValueFromPointer:Fr(t,n),destructorFunction:null})}function kr(e,t,r){switch(t){case 0:return r?function(i){return Oe[i]}:function(i){return C[i]};case 1:return r?function(i){return q[i>>1]}:function(i){return de[i>>1]};case 2:return r?function(i){return W[i>>2]}:function(i){return T[i>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Er(e,t,r,n,i){t=$(t);var a=Ue(r),o=c=>c;if(n===0){var s=32-8*r;o=c=>c<<s>>>s}var f=t.includes("unsigned"),l=(c,d)=>{},u;f?u=function(c,d){return l(d,this.name),d>>>0}:u=function(c,d){return l(d,this.name),d},A(e,{name:t,fromWireType:o,toWireType:u,argPackAdvance:8,readValueFromPointer:kr(t,a,n!==0),destructorFunction:null})}function Or(e,t,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],i=n[t];function a(o){o=o>>2;var s=T,f=s[o],l=s[o+1];return new i(s.buffer,l,f)}r=$(r),A(e,{name:r,fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{ignoreDuplicateRegistrations:!0})}function Ur(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t}function Mr(e,t){t=$(t);var r=t==="std::string";A(e,{name:t,fromWireType:function(n){var i=T[n>>2],a=n+4,o;if(r)for(var s=a,f=0;f<=i;++f){var l=a+f;if(f==i||C[l]==0){var u=l-s,c=ne(s,u);o===void 0?o=c:(o+=String.fromCharCode(0),o+=c),s=l+1}}else{for(var d=new Array(i),f=0;f<i;++f)d[f]=String.fromCharCode(C[a+f]);o=d.join("")}return F(n),o},toWireType:function(n,i){i instanceof ArrayBuffer&&(i=new Uint8Array(i));var a,o=typeof i=="string";o||i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Int8Array||g("Cannot pass non-string to std::string"),r&&o?a=Ur(i):a=i.length;var s=he(4+a+1),f=s+4;if(T[s>>2]=a,r&&o)Mt(i,f,a+1);else if(o)for(var l=0;l<a;++l){var u=i.charCodeAt(l);u>255&&(F(f),g("String has UTF-16 code units that do not fit in 8 bits")),C[f+l]=u}else for(var l=0;l<a;++l)C[f+l]=i[l];return n!==null&&n.push(F,s),s},argPackAdvance:8,readValueFromPointer:pe,destructorFunction:function(n){F(n)}})}var Dr=new TextDecoder("utf-16le");function Wr(e,t){for(var r=e,n=r>>1,i=n+t/2;!(n>=i)&&de[n];)++n;return r=n<<1,Dr.decode(C.subarray(e,r))}function Rr(e,t,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var n=t,i=r<e.length*2?r/2:e.length,a=0;a<i;++a){var o=e.charCodeAt(a);q[t>>1]=o,t+=2}return q[t>>1]=0,t-n}function Ir(e){return e.length*2}function jr(e,t){for(var r=0,n="";!(r>=t/4);){var i=W[e+r*4>>2];if(i==0)break;if(++r,i>=65536){var a=i-65536;n+=String.fromCharCode(55296|a>>10,56320|a&1023)}else n+=String.fromCharCode(i)}return n}function Lr(e,t,r){if(r===void 0&&(r=2147483647),r<4)return 0;for(var n=t,i=n+r-4,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343){var s=e.charCodeAt(++a);o=65536+((o&1023)<<10)|s&1023}if(W[t>>2]=o,t+=4,t+4>i)break}return W[t>>2]=0,t-n}function Hr(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t}function Br(e,t,r){r=$(r);var n,i,a,o,s;t===2?(n=Wr,i=Rr,o=Ir,a=()=>de,s=1):t===4&&(n=jr,i=Lr,o=Hr,a=()=>T,s=2),A(e,{name:r,fromWireType:function(f){for(var l=T[f>>2],u=a(),c,d=f+4,p=0;p<=l;++p){var y=f+4+p*t;if(p==l||u[y>>s]==0){var w=y-d,m=n(d,w);c===void 0?c=m:(c+=String.fromCharCode(0),c+=m),d=y+t}}return F(f),c},toWireType:function(f,l){typeof l!="string"&&g("Cannot pass non-string to C++ string type "+r);var u=o(l),c=he(4+u+t);return T[c>>2]=u>>s,i(l,c+4,u+t),f!==null&&f.push(F,c),c},argPackAdvance:8,readValueFromPointer:pe,destructorFunction:function(f){F(f)}})}function Vr(e,t){t=$(t),A(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,n){}})}function xr(){throw 1/0}function zr(){rt("")}var mt;mt=()=>performance.now();function Jr(e,t,r){C.copyWithin(e,t,t+r)}function Gr(){return 2147483648}function Xr(e){var t=B.buffer;try{return B.grow(e-t.byteLength+65535>>>16),le(),1}catch{}}function qr(e){var t=C.length;e=e>>>0;var r=Gr();if(e>r)return!1;for(var n=(f,l)=>f+(l-f%l)%l,i=1;i<=4;i*=2){var a=t*(1+.2/i);a=Math.min(a,e+100663296);var o=Math.min(r,n(Math.max(e,a),65536)),s=Xr(o);if(s)return!0}return!1}function Yr(e){throw"exit("+e+")"}var Kr=Yr;function Qr(e){return 52}function Zr(e,t,r,n){return 52}function Nr(e,t,r,n,i){return 70}var en=[null,[],[]];function tn(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;return st.decode(e.buffer?e.subarray(t,i):new Uint8Array(e.slice(t,i)))}function rn(e,t){var r=en[e];t===0||t===10?((e===1?Ge:Xe)(tn(r,0)),r.length=0):r.push(t)}function nn(e,t,r,n){for(var i=0,a=0;a<r;a++){var o=T[t>>2],s=T[t+4>>2];t+=8;for(var f=0;f<s;f++)rn(e,C[o+f]);i+=s}return T[n>>2]=i,0}jt();H=v.BindingError=We(Error,"BindingError");lt=v.InternalError=We(Error,"InternalError");rr();qt();cr();pt=v.UnboundTypeError=We(Error,"UnboundTypeError");Pr();var on={a:Et,m:Ot,z:Dt,D:Wt,l:Rt,t:It,p:Bt,j:yr,s:wr,c:br,b:Cr,E:Sr,n:Ar,f:Er,d:Or,o:Mr,k:Br,q:Vr,x:xr,e:zr,g:mt,A:Jr,y:qr,h:Kr,i:Qr,C:Zr,r:Nr,B:nn,w:sn,u:ln,v:an};function sn(e,t,r){var n=ye();try{return Q(e)(t,r)}catch(i){if(me(n),i!==i+0)throw i;ve(1,0)}}function an(e,t,r,n,i){var a=ye();try{return Q(e)(t,r,n,i)}catch(o){if(me(a),o!==o+0)throw o;ve(1,0)}}function ln(e,t,r,n){var i=ye();try{return Q(e)(t,r,n)}catch(a){if(me(i),a!==a+0)throw a;ve(1,0)}}function fn(e){e.G()}var Je={a:on},he,F,wt,ve,ye,me;(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(fetch("jassub-worker.wasm"),Je):WebAssembly.instantiate(v.wasm,Je)).then(function(e){asm=(e.instance||e).exports,he=asm.H,F=asm.I,wt=asm.J,asm.K,ve=asm.M,ye=asm.N,me=asm.O,asm.P,asm.Q,asm.R,asm.S,ot=asm.L,B=asm.F,le(),fn(asm),qe()});
