var v=v,Ge=e=>console.log(e),Xe=e=>console.error(e);function qe(){}self.assert||(self.assert=(e,t)=>{if(!e)throw t});String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t===void 0&&(t=0),this.substring(t,e.length)===e});String.prototype.includes||(String.prototype.includes=function(e,t){return this.indexOf(e,t)!==-1});if(!ArrayBuffer.isView){const e=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];ArrayBuffer.isView=t=>t&&t.constructor&&e.indexOf(t.constructor)!==-1}Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){return new Uint8Array(this.subarray(e,t))});Date.now||(Date.now=()=>new Date().getTime());"performance"in self||(self.performance={now:()=>Date.now()});if(typeof console>"u"){const e=(t,r)=>{postMessage({target:"console",command:t,content:JSON.stringify(Array.prototype.slice.call(r))})};console={log:function(){e("log",arguments)},debug:function(){e("debug",arguments)},info:function(){e("info",arguments)},warn:function(){e("warn",arguments)},error:function(){e("error",arguments)}},console.log("Detected lack of console, overridden console")}const Te=(e,t)=>{const r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType=t?"arraybuffer":"text",r.send(null),r.response},Tt=(e,t,r)=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{if((n.status===200||n.status===0)&&n.response)return t(n.response);r()},n.onerror=r,n.send(null)};v={wasm:WebAssembly&&!WebAssembly.instantiateStreaming&&Te("jassub-worker.wasm",!0)};qe=()=>postMessage({target:"ready"});Ge=e=>{e==="JASSUB: No usable fontconfig configuration file found, using fallback."?console.debug(e):console.log(e)};Xe=e=>{e==="Fontconfig error: Cannot load default config file: No such file: (null)"?console.debug(e):console.error(e)};let X=0;const Pt=1;let E=null,Le=!1,Pe=Date.now(),ie=24,Ye=!1,Ke="js",se={};const He={};let St=0,Qe;self.width=0;self.height=0;let M=!1;self.addFont=({font:e})=>Se(e);const Ce=e=>{e=e.trim().toLowerCase(),e.startsWith("@")&&(e=e.substring(1)),!He[e]&&(He[e]=!0,se[e]?Se(se[e]):Ye&&postMessage({target:"getLocalFont",font:e}))},Se=e=>{ArrayBuffer.isView(e)?Ve(e):Tt(e,t=>{Ve(new Uint8Array(t))},console.error)},Ve=e=>{const t=he(e.byteLength);_.set(e,t),h.addFont("font-"+St++,t,e.byteLength),h.reloadFonts()},Ze=e=>{if(!se)return;const t=kt(e);for(let i=0;i<t.length;i++)for(let a=0;a<t[i].body.length;a++)t[i].body[a].key==="Style"&&Ce(t[i].body[a].value.Fontname);const r=/\\fn([^\\}]*?)[\\}]/g;let n;for(;(n=r.exec(e))!==null;)Ce(n[1])};self.setTrack=({content:e})=>{Ze(e),h.createTrackMem(e),ke=et[h.trackColorSpace]};self.freeTrack=()=>{h.removeTrack()};self.setTrackByUrl=({url:e})=>{self.setTrack({content:Te(e)})};const Ft=()=>{const e=(Date.now()-Pe)/1e3;return ae?X:(e>5&&(console.error("Didn't received currentTime > 5 seconds. Assuming video was paused."),Ne(!0)),X+e*Pt)},At=e=>{X=e,Pe=Date.now(),E||(Le?E=Ae(oe):(oe(),setTimeout(()=>{Le=!1},20)))};let ae=!0;const Ne=e=>{e!==ae&&(ae=e,e?E&&(clearTimeout(E),E=null):(Pe=Date.now(),E=Ae(oe)))},B="BT.601",Be="BT.709",xe="SMPTE240M",et=[B,B,B,B,B,Be,Be,xe,xe,"FCC","FCC"],Fe=(e,t)=>{const r=performance.now(),n=Ke==="wasm"?h.renderBlend(e,t||0):h.renderImage(e,t||0),i={renderTime:performance.now()-r-h.time,decodeTime:h.time};if(h.changed!==0||t){const a=[];let s=[];const o=performance.now();if(!n)return we({images:a,buffers:s,times:i,decodeStartTime:o});if(M){const f=[];for(let l=n,u=0;u<h.count;l=l.next,++u)a.push({w:l.w,h:l.h,x:l.x,y:l.y}),f.push(createImageBitmap(new ImageData(Ee.slice(l.image,l.image+l.w*l.h*4),l.w,l.h)));Promise.all(f).then(l=>{for(let u=0;u<a.length;u++)a[u].image=l[u];s=l,we({images:a,buffers:s,times:i,decodeStartTime:o})})}else{for(let f=n,l=0;l<h.count;f=f.next,++l){const u={w:f.w,h:f.h,x:f.x,y:f.y,image:f.image};if(!j){const c=V.buffer.slice(f.image,f.image+f.w*f.h*4);s.push(c),u.image=c}a.push(u)}we({images:a,buffers:s,times:i,decodeStartTime:o})}}else postMessage({target:"unbusy"})};self.demand=({time:e})=>{X=e,Fe(e)};const oe=e=>{E=0,Fe(Ft(),e),ae||(E=Ae(oe))},we=({times:e,images:t,decodeStartTime:r,buffers:n})=>{e.decodeTime=performance.now()-r;const i={target:"render",async:M,images:t,times:e,width:self.width,height:self.height,colorSpace:ke};if(j){const a=performance.now();(D.height!==self.height||D.width!==self.width)&&(D.width=self.width,D.height=self.height),j.clearRect(0,0,self.width,self.height);for(const s of t)s.image&&(M?(j.drawImage(s.image,s.x,s.y),s.image.close()):(x.width=s.w,x.height=s.h,tt.putImageData(new ImageData(Ee.subarray(s.image,s.image+s.w*s.h*4),s.w,s.h),0,0),j.drawImage(x,s.x,s.y)));Qe&&(e.drawTime=performance.now()-a);try{const s=D.transferToImageBitmap();i.images=[{image:s,x:0,y:0}],i.async=!0,postMessage(i,[s])}catch{postMessage({target:"unbusy"})}}else postMessage(i,n)},kt=e=>{let t,r,n,i,a,s,o,f,l,u;const c=[],d=e.split(/[\r\n]+/g);for(f=0;f<d.length;f++)if(t=d[f].match(/^\[(.*)\]$/),t)r=null,c.push({name:t[1],body:[]});else{if(/^\s*$/.test(d[f])||c.length===0)continue;if(u=c[c.length-1].body,d[f][0]===";")u.push({type:"comment",value:d[f].substring(1)});else{if(i=d[f].split(":"),a=i[0],s=i.slice(1).join(":").trim(),(r||a==="Format")&&(s=s.split(","),r&&s.length>r.length&&(n=s.slice(r.length-1).join(","),s=s.slice(0,r.length-1),s.push(n)),s=s.map(p=>p.trim()),r)){for(o={},l=0;l<s.length;l++)o[r[l]]=s[l];s=o}a==="Format"&&(r=s),u.push({key:a,value:s})}}return c},Ae=(()=>{let e=0;return t=>{const r=Date.now();if(e===0)e=r+1e3/ie;else for(;r+2>=e;)e+=1e3/ie;const n=Math.max(e-r,0);return setTimeout(t,n)}})(),ce=(e,t)=>{for(const r of Object.keys(e))t[r]=e[r]};let D,j,x,tt,h,ke;self.init=e=>{self.width=e.width,self.height=e.height,Ke=e.blendMode,M=e.asyncRender,M&&typeof createImageBitmap>"u"&&(M=!1,console.error("'createImageBitmap' needed for 'asyncRender' unsupported!")),se=e.availableFonts,Qe=e.debug,ie=e.targetFps||ie,Ye=e.useLocalFonts;const t=e.fallbackFont.toLowerCase();h=new v.JASSUB(self.width,self.height,t||null),t&&Ce(t);let r=e.subContent;r||(r=Te(e.subUrl)),Ze(r);for(const n of e.fonts||[])Se(n);h.createTrackMem(r),ke=et[h.trackColorSpace],h.setDropAnimations(e.dropAllAnimations||0),(e.libassMemoryLimit>0||e.libassGlyphLimit>0)&&h.setMemoryLimits(e.libassGlyphLimit||0,e.libassMemoryLimit||0),e.offscreenRender&&(D=new OffscreenCanvas(self.height,self.width),j=D.getContext("2d",{desynchronized:!0}),M||(x=new OffscreenCanvas(self.height,self.width),tt=x.getContext("2d",{desynchronized:!0})))};self.canvas=({width:e,height:t,force:r})=>{if(e==null)throw new Error("Invalid canvas size specified");self.width=e,self.height=t,h.resizeCanvas(e,t),r&&Fe(X)};self.video=({currentTime:e,isPaused:t,rate:r})=>{e!=null&&At(e),t!=null&&Ne(t),r=r||r};self.destroy=()=>{h.quitLibrary()};self.createEvent=({event:e})=>{ce(e,h.getEvent(h.allocEvent()))};self.getEvents=()=>{const e=[];for(let t=0;t<h.getEventCount();t++){const{Start:r,Duration:n,ReadOrder:i,Layer:a,Style:s,MarginL:o,MarginR:f,MarginV:l,Name:u,Text:c,Effect:d}=h.getEvent(t);e.push({Start:r,Duration:n,ReadOrder:i,Layer:a,Style:s,MarginL:o,MarginR:f,MarginV:l,Name:u,Text:c,Effect:d})}postMessage({target:"getEvents",events:e})};self.setEvent=({event:e,index:t})=>{ce(e,h.getEvent(t))};self.removeEvent=({index:e})=>{h.removeEvent(e)};self.createStyle=({style:e})=>{ce(e,h.getStyle(h.allocStyle()))};self.getStyles=()=>{const e=[];for(let t=0;t<h.getStyleCount();t++){const{Name:r,FontName:n,FontSize:i,PrimaryColour:a,SecondaryColour:s,OutlineColour:o,BackColour:f,Bold:l,Italic:u,Underline:c,StrikeOut:d,ScaleX:p,ScaleY:y,Spacing:b,Angle:m,BorderStyle:C,Outline:U,Shadow:w,Alignment:be,MarginL:Z,MarginR:N,MarginV:ee,Encoding:wt,treat_fontname_as_pattern:_t,Blur:Ct,Justify:$t}=h.getStyle(t);e.push({Name:r,FontName:n,FontSize:i,PrimaryColour:a,SecondaryColour:s,OutlineColour:o,BackColour:f,Bold:l,Italic:u,Underline:c,StrikeOut:d,ScaleX:p,ScaleY:y,Spacing:b,Angle:m,BorderStyle:C,Outline:U,Shadow:w,Alignment:be,MarginL:Z,MarginR:N,MarginV:ee,Encoding:wt,treat_fontname_as_pattern:_t,Blur:Ct,Justify:$t})}postMessage({target:"getStyles",time:Date.now(),styles:e})};self.setStyle=({style:e,index:t})=>{ce(e,h.getStyle(t))};self.removeStyle=({index:e})=>{h.removeStyle(e)};onmessage=({data:e})=>{if(self[e.target])self[e.target](e);else throw new Error("Unknown event target "+e.target)};let Ee=null;le=(e=>()=>{e(),Ee=new Uint8ClampedArray(V.buffer)})(le);function rt(e){throw e}var Oe,q,W,_,de,T,nt,it,V,st;function le(){var e=V.buffer;Oe=new Int8Array(e),q=new Int16Array(e),W=new Int32Array(e),_=new Uint8Array(e),de=new Uint16Array(e),T=new Uint32Array(e),nt=new Float32Array(e),it=new Float64Array(e)}var at=new TextDecoder("utf8");function ne(e,t){if(!e)return"";for(var r=e+t,n=e;!(n>=r)&&_[n];)++n;return at.decode(_.subarray(e,n))}function Et(e,t,r,n){rt(`Assertion failed: ${ne(e)}, at: `+[t?ne(t):"unknown filename",r,n?ne(n):"unknown function"])}function Ot(e,t,r){return 0}function Ut(e,t){}function Dt(e,t,r,n){if(!(n>0))return 0;for(var i=r,a=r+n-1,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343){var f=e.charCodeAt(++s);o=65536+((o&1023)<<10)|f&1023}if(o<=127){if(r>=a)break;t[r++]=o}else if(o<=2047){if(r+1>=a)break;t[r++]=192|o>>6,t[r++]=128|o&63}else if(o<=65535){if(r+2>=a)break;t[r++]=224|o>>12,t[r++]=128|o>>6&63,t[r++]=128|o&63}else{if(r+3>=a)break;t[r++]=240|o>>18,t[r++]=128|o>>12&63,t[r++]=128|o>>6&63,t[r++]=128|o&63}}return t[r]=0,r-i}function Mt(e,t,r){return Dt(e,_,t,r)}function Wt(e,t,r){}function Rt(e,t,r){return 0}function jt(e,t,r,n){}function It(e,t,r,n){}function Lt(e,t){}function Ht(e,t,r,n,i){}function Ue(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function Vt(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ot=e}var ot=void 0;function $(e){for(var t="",r=e;_[r];)t+=ot[_[r++]];return t}var I={},L={},fe={},Bt=48,xt=57;function De(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=Bt&&t<=xt?"_"+e:e}function Me(e,t){return e=De(e),{[e]:function(){return t.apply(this,arguments)}}[e]}function We(e,t){var r=Me(t,function(n){this.name=t,this.message=n;var i=new Error(n).stack;i!==void 0&&(this.stack=this.toString()+`
`+i.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var H=void 0;function g(e){throw new H(e)}var lt=void 0;function ue(e){throw new lt(e)}function R(e,t,r){e.forEach(function(o){fe[o]=t});function n(o){var f=r(o);f.length!==e.length&&ue("Mismatched type converter count");for(var l=0;l<e.length;++l)A(e[l],f[l])}var i=new Array(t.length),a=[],s=0;t.forEach((o,f)=>{L.hasOwnProperty(o)?i[f]=L[o]:(a.push(o),I.hasOwnProperty(o)||(I[o]=[]),I[o].push(()=>{i[f]=L[o],++s,s===a.length&&n(i)}))}),a.length===0&&n(i)}function A(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=t.name;if(e||g(`type "${n}" must have a positive integer typeid pointer`),L.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;g(`Cannot register type '${n}' twice`)}if(L[e]=t,delete fe[e],I.hasOwnProperty(e)){var i=I[e];delete I[e],i.forEach(a=>a())}}function zt(e,t,r,n,i){var a=Ue(r);t=$(t),A(e,{name:t,fromWireType:function(s){return!!s},toWireType:function(s,o){return o?n:i},argPackAdvance:8,readValueFromPointer:function(s){var o;if(r===1)o=Oe;else if(r===2)o=q;else if(r===4)o=W;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(o[s>>a])},destructorFunction:null})}function Jt(e){if(!(this instanceof k)||!(e instanceof k))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=e.$$.ptrType.registeredClass,i=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)i=n.upcast(i),n=n.baseClass;return t===n&&r===i}function Gt(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Re(e){function t(r){return r.$$.ptrType.registeredClass.name}g(t(e)+" instance already deleted")}var _e=!1;function ft(e){}function Xt(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function ut(e){e.count.value-=1;var t=e.count.value===0;t&&Xt(e)}function ct(e,t,r){if(t===r)return e;if(r.baseClass===void 0)return null;var n=ct(e,t,r.baseClass);return n===null?null:r.downcast(n)}var dt={};function qt(){return Object.keys(J).length}function Yt(){var e=[];for(var t in J)J.hasOwnProperty(t)&&e.push(J[t]);return e}var Y=[];function je(){for(;Y.length;){var e=Y.pop();e.$$.deleteScheduled=!1,e.delete()}}var z=void 0;function Kt(e){z=e,Y.length&&z&&z(je)}function Qt(){v.getInheritedInstanceCount=qt,v.getLiveInheritedInstances=Yt,v.flushPendingDeletes=je,v.setDelayFunction=Kt}var J={};function Zt(e,t){for(t===void 0&&g("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function Nt(e,t){return t=Zt(e,t),J[t]}function te(e,t){(!t.ptrType||!t.ptr)&&ue("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,n=!!t.smartPtr;return r!==n&&ue("Both smartPtrType and smartPtr must be specified"),t.count={value:1},G(Object.create(e,{$$:{value:t}}))}function er(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=Nt(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function i(){return this.isSmartPointer?te(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):te(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var a=this.registeredClass.getActualType(t),s=dt[a];if(!s)return i.call(this);var o;this.isConst?o=s.constPointerType:o=s.pointerType;var f=ct(t,this.registeredClass,o.registeredClass);return f===null?i.call(this):this.isSmartPointer?te(o.registeredClass.instancePrototype,{ptrType:o,ptr:f,smartPtrType:this,smartPtr:e}):te(o.registeredClass.instancePrototype,{ptrType:o,ptr:f})}function G(e){return typeof FinalizationRegistry>"u"?(G=t=>t,e):(_e=new FinalizationRegistry(t=>{ut(t.$$)}),G=t=>{var r=t.$$,n=!!r.smartPtr;if(n){var i={$$:r};_e.register(t,i,t)}return t},ft=t=>_e.unregister(t),G(e))}function tr(){if(this.$$.ptr||Re(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=G(Object.create(Object.getPrototypeOf(this),{$$:{value:Gt(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function rr(){this.$$.ptr||Re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&g("Object already scheduled for deletion"),ft(this),ut(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function nr(){return!this.$$.ptr}function ir(){return this.$$.ptr||Re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&g("Object already scheduled for deletion"),Y.push(this),Y.length===1&&z&&z(je),this.$$.deleteScheduled=!0,this}function sr(){k.prototype.isAliasOf=Jt,k.prototype.clone=tr,k.prototype.delete=rr,k.prototype.isDeleted=nr,k.prototype.deleteLater=ir}function k(){}function gt(e,t,r){if(e[t].overloadTable===void 0){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||g(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}}function ar(e,t,r){v.hasOwnProperty(e)?((r===void 0||v[e].overloadTable!==void 0&&v[e].overloadTable[r]!==void 0)&&g(`Cannot register public name '${e}' twice`),gt(v,e,e),v.hasOwnProperty(r)&&g(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),v[e].overloadTable[r]=t):(v[e]=t,r!==void 0&&(v[e].numArguments=r))}function or(e,t,r,n,i,a,s,o){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=i,this.getActualType=a,this.upcast=s,this.downcast=o,this.pureVirtualFunctions=[]}function ge(e,t,r){for(;t!==r;)t.upcast||g(`Expected null or instance of ${r.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e}function lr(e,t){if(t===null)return this.isReference&&g("null is not a valid "+this.name),0;t.$$||g(`Cannot pass "${Ie(t)}" as a ${this.name}`),t.$$.ptr||g("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass,n=ge(t.$$.ptr,r,this.registeredClass);return n}function fr(e,t){var r;if(t===null)return this.isReference&&g("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;t.$$||g(`Cannot pass "${Ie(t)}" as a ${this.name}`),t.$$.ptr||g(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&g(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var n=t.$$.ptrType.registeredClass;if(r=ge(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&g("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:g(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var i=t.clone();r=this.rawShare(r,$e.toHandle(function(){i.delete()})),e!==null&&e.push(this.rawDestructor,r)}break;default:g("Unsupporting sharing policy")}return r}function ur(e,t){if(t===null)return this.isReference&&g("null is not a valid "+this.name),0;t.$$||g(`Cannot pass "${Ie(t)}" as a ${this.name}`),t.$$.ptr||g(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&g(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var r=t.$$.ptrType.registeredClass,n=ge(t.$$.ptr,r,this.registeredClass);return n}function pe(e){return this.fromWireType(W[e>>2])}function cr(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function dr(e){this.rawDestructor&&this.rawDestructor(e)}function gr(e){e!==null&&e.delete()}function pr(){S.prototype.getPointee=cr,S.prototype.destructor=dr,S.prototype.argPackAdvance=8,S.prototype.readValueFromPointer=pe,S.prototype.deleteObject=gr,S.prototype.fromWireType=er}function S(e,t,r,n,i,a,s,o,f,l,u){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=i,this.pointeeType=a,this.sharingPolicy=s,this.rawGetPointee=o,this.rawConstructor=f,this.rawShare=l,this.rawDestructor=u,!i&&t.baseClass===void 0?n?(this.toWireType=lr,this.destructorFunction=null):(this.toWireType=ur,this.destructorFunction=null):this.toWireType=fr}function hr(e,t,r){v.hasOwnProperty(e)||ue("Replacing nonexistant public symbol"),v[e].overloadTable!==void 0&&r!==void 0?v[e].overloadTable[r]=t:(v[e]=t,v[e].argCount=r)}function vr(e,t,r){var n=dynCalls[e];return r&&r.length?n.apply(null,[t].concat(r)):n.call(null,t)}var re=[];function Q(e){var t=re[e];return t||(e>=re.length&&(re.length=e+1),re[e]=t=st.get(e)),t}function yr(e,t,r){if(e.includes("j"))return vr(e,t,r);var n=Q(t).apply(null,r);return n}function mr(e,t){var r=[];return function(){return r.length=0,Object.assign(r,arguments),yr(e,t,r)}}function O(e,t){e=$(e);function r(){return e.includes("j")?mr(e,t):Q(t)}var n=r();return typeof n!="function"&&g(`unknown function pointer with signature ${e}: ${t}`),n}var pt=void 0;function br(e){var t=bt(e),r=$(t);return F(t),r}function K(e,t){var r=[],n={};function i(a){if(!n[a]&&!L[a]){if(fe[a]){fe[a].forEach(i);return}r.push(a),n[a]=!0}}throw t.forEach(i),new pt(e+": "+r.map(br).join([", "]))}function wr(e,t,r,n,i,a,s,o,f,l,u,c,d){u=$(u),a=O(i,a),o&&(o=O(s,o)),l&&(l=O(f,l)),d=O(c,d);var p=De(u);ar(p,function(){K(`Cannot construct ${u} due to unbound types`,[n])}),R([e,t,r],n?[n]:[],function(y){y=y[0];var b,m;n?(b=y.registeredClass,m=b.instancePrototype):m=k.prototype;var C=Me(p,function(){if(Object.getPrototypeOf(this)!==U)throw new H("Use 'new' to construct "+u);if(w.constructor_body===void 0)throw new H(u+" has no accessible constructor");var ee=w.constructor_body[arguments.length];if(ee===void 0)throw new H(`Tried to invoke ctor of ${u} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(w.constructor_body).toString()}) parameters instead!`);return ee.apply(this,arguments)}),U=Object.create(m,{constructor:{value:C}});C.prototype=U;var w=new or(u,C,U,d,b,a,o,l);w.baseClass&&(w.baseClass.__derivedClasses===void 0&&(w.baseClass.__derivedClasses=[]),w.baseClass.__derivedClasses.push(w));var be=new S(u,w,!0,!1,!1),Z=new S(u+"*",w,!1,!1,!1),N=new S(u+" const*",w,!1,!0,!1);return dt[e]={pointerType:Z,constPointerType:N},hr(p,C),[be,Z,N]})}function ht(e,t){for(var r=[],n=0;n<e;n++)r.push(T[t+n*4>>2]);return r}function vt(e){for(;e.length;){var t=e.pop(),r=e.pop();r(t)}}function _r(e,t){if(!(e instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof e} which is not a function`);var r=Me(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var n=new r,i=e.apply(n,t);return i instanceof Object?i:n}function yt(e,t,r,n,i,a){var s=t.length;s<2&&g("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var o=t[1]!==null&&r!==null,f=!1,l=1;l<t.length;++l)if(t[l]!==null&&t[l].destructorFunction===void 0){f=!0;break}for(var u=t[0].name!=="void",c="",d="",l=0;l<s-2;++l)c+=(l!==0?", ":"")+"arg"+l,d+=(l!==0?", ":"")+"arg"+l+"Wired";var p="return function "+De(e)+"("+c+`) {
if (arguments.length !== `+(s-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(s-2)+` args!');
}
`;f&&(p+=`var destructors = [];
`);var y=f?"destructors":"null",b=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],m=[g,n,i,vt,t[0],t[1]];o&&(p+="var thisWired = classParam.toWireType("+y+`, this);
`);for(var l=0;l<s-2;++l)p+="var arg"+l+"Wired = argType"+l+".toWireType("+y+", arg"+l+"); // "+t[l+2].name+`
`,b.push("argType"+l),m.push(t[l+2]);if(o&&(d="thisWired"+(d.length>0?", ":"")+d),p+=(u||a?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+`);
`,f)p+=`runDestructors(destructors);
`;else for(var l=o?1:2;l<t.length;++l){var C=l===1?"thisWired":"arg"+(l-2)+"Wired";t[l].destructorFunction!==null&&(p+=C+"_dtor("+C+"); // "+t[l].name+`
`,b.push(C+"_dtor"),m.push(t[l].destructorFunction))}return u&&(p+=`var ret = retType.fromWireType(rv);
return ret;
`),p+=`}
`,b.push(p),_r(Function,b).apply(null,m)}function Cr(e,t,r,n,i,a){assert(t>0);var s=ht(t,r);i=O(n,i),R([],[e],function(o){o=o[0];var f="constructor "+o.name;if(o.registeredClass.constructor_body===void 0&&(o.registeredClass.constructor_body=[]),o.registeredClass.constructor_body[t-1]!==void 0)throw new H(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${o.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return o.registeredClass.constructor_body[t-1]=()=>{K(`Cannot construct ${o.name} due to unbound types`,s)},R([],s,function(l){return l.splice(1,0,null),o.registeredClass.constructor_body[t-1]=yt(f,l,null,i,a),[]}),[]})}function $r(e,t,r,n,i,a,s,o,f){var l=ht(r,n);t=$(t),a=O(i,a),R([],[e],function(u){u=u[0];var c=u.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),o&&u.registeredClass.pureVirtualFunctions.push(t);function d(){K(`Cannot call ${c} due to unbound types`,l)}var p=u.registeredClass.instancePrototype,y=p[t];return y===void 0||y.overloadTable===void 0&&y.className!==u.name&&y.argCount===r-2?(d.argCount=r-2,d.className=u.name,p[t]=d):(gt(p,t,c),p[t].overloadTable[r-2]=d),R([],l,function(b){var m=yt(c,b,u,a,s,f);return p[t].overloadTable===void 0?(m.argCount=r-2,p[t]=m):p[t].overloadTable[r-2]=m,[]}),[]})}function ze(e,t,r){return e instanceof Object||g(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||g(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||g(`cannot call emscripten binding method ${r} on deleted object`),ge(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}function Tr(e,t,r,n,i,a,s,o,f,l){t=$(t),i=O(n,i),R([],[e],function(u){u=u[0];var c=u.name+"."+t,d={get:function(){K(`Cannot access ${c} due to unbound types`,[r,s])},enumerable:!0,configurable:!0};return f?d.set=()=>{K(`Cannot access ${c} due to unbound types`,[r,s])}:d.set=p=>{g(c+" is a read-only property")},Object.defineProperty(u.registeredClass.instancePrototype,t,d),R([],f?[r,s]:[r],function(p){var y=p[0],b={get:function(){var C=ze(this,u,c+" getter");return y.fromWireType(i(a,C))},enumerable:!0};if(f){f=O(o,f);var m=p[1];b.set=function(C){var U=ze(this,u,c+" setter"),w=[];f(l,U,m.toWireType(w,C)),vt(w)}}return Object.defineProperty(u.registeredClass.instancePrototype,t,b),[]}),[]})}function Pr(){this.allocated=[void 0],this.freelist=[],this.get=function(e){return this.allocated[e]},this.allocate=function(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},this.free=function(e){this.allocated[e]=void 0,this.freelist.push(e)}}var P=new Pr;function Sr(e){e>=P.reserved&&--P.get(e).refcount===0&&P.free(e)}function Fr(){for(var e=0,t=P.reserved;t<P.allocated.length;++t)P.allocated[t]!==void 0&&++e;return e}function Ar(){P.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),P.reserved=P.allocated.length,v.count_emval_handles=Fr}var $e={toValue:e=>(e||g("Cannot use deleted val. handle = "+e),P.get(e).value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return P.allocate({refcount:1,value:e})}}};function kr(e,t){t=$(t),A(e,{name:t,fromWireType:function(r){var n=$e.toValue(r);return Sr(r),n},toWireType:function(r,n){return $e.toHandle(n)},argPackAdvance:8,readValueFromPointer:pe,destructorFunction:null})}function Ie(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function Er(e,t){switch(t){case 2:return function(r){return this.fromWireType(nt[r>>2])};case 3:return function(r){return this.fromWireType(it[r>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Or(e,t,r){var n=Ue(r);t=$(t),A(e,{name:t,fromWireType:function(i){return i},toWireType:function(i,a){return a},argPackAdvance:8,readValueFromPointer:Er(t,n),destructorFunction:null})}function Ur(e,t,r){switch(t){case 0:return r?function(i){return Oe[i]}:function(i){return _[i]};case 1:return r?function(i){return q[i>>1]}:function(i){return de[i>>1]};case 2:return r?function(i){return W[i>>2]}:function(i){return T[i>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Dr(e,t,r,n,i){t=$(t);var a=Ue(r),s=c=>c;if(n===0){var o=32-8*r;s=c=>c<<o>>>o}var f=t.includes("unsigned"),l=(c,d)=>{},u;f?u=function(c,d){return l(d,this.name),d>>>0}:u=function(c,d){return l(d,this.name),d},A(e,{name:t,fromWireType:s,toWireType:u,argPackAdvance:8,readValueFromPointer:Ur(t,a,n!==0),destructorFunction:null})}function Mr(e,t,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],i=n[t];function a(s){s=s>>2;var o=T,f=o[s],l=o[s+1];return new i(o.buffer,l,f)}r=$(r),A(e,{name:r,fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{ignoreDuplicateRegistrations:!0})}function Wr(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t}function Rr(e,t){t=$(t);var r=t==="std::string";A(e,{name:t,fromWireType:function(n){var i=T[n>>2],a=n+4,s;if(r)for(var o=a,f=0;f<=i;++f){var l=a+f;if(f==i||_[l]==0){var u=l-o,c=ne(o,u);s===void 0?s=c:(s+=String.fromCharCode(0),s+=c),o=l+1}}else{for(var d=new Array(i),f=0;f<i;++f)d[f]=String.fromCharCode(_[a+f]);s=d.join("")}return F(n),s},toWireType:function(n,i){i instanceof ArrayBuffer&&(i=new Uint8Array(i));var a,s=typeof i=="string";s||i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Int8Array||g("Cannot pass non-string to std::string"),r&&s?a=Wr(i):a=i.length;var o=he(4+a+1),f=o+4;if(T[o>>2]=a,r&&s)Mt(i,f,a+1);else if(s)for(var l=0;l<a;++l){var u=i.charCodeAt(l);u>255&&(F(f),g("String has UTF-16 code units that do not fit in 8 bits")),_[f+l]=u}else for(var l=0;l<a;++l)_[f+l]=i[l];return n!==null&&n.push(F,o),o},argPackAdvance:8,readValueFromPointer:pe,destructorFunction:function(n){F(n)}})}var jr=new TextDecoder("utf-16le");function Ir(e,t){for(var r=e,n=r>>1,i=n+t/2;!(n>=i)&&de[n];)++n;return r=n<<1,jr.decode(_.subarray(e,r))}function Lr(e,t,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var n=t,i=r<e.length*2?r/2:e.length,a=0;a<i;++a){var s=e.charCodeAt(a);q[t>>1]=s,t+=2}return q[t>>1]=0,t-n}function Hr(e){return e.length*2}function Vr(e,t){for(var r=0,n="";!(r>=t/4);){var i=W[e+r*4>>2];if(i==0)break;if(++r,i>=65536){var a=i-65536;n+=String.fromCharCode(55296|a>>10,56320|a&1023)}else n+=String.fromCharCode(i)}return n}function Br(e,t,r){if(r===void 0&&(r=2147483647),r<4)return 0;for(var n=t,i=n+r-4,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343){var o=e.charCodeAt(++a);s=65536+((s&1023)<<10)|o&1023}if(W[t>>2]=s,t+=4,t+4>i)break}return W[t>>2]=0,t-n}function xr(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t}function zr(e,t,r){r=$(r);var n,i,a,s,o;t===2?(n=Ir,i=Lr,s=Hr,a=()=>de,o=1):t===4&&(n=Vr,i=Br,s=xr,a=()=>T,o=2),A(e,{name:r,fromWireType:function(f){for(var l=T[f>>2],u=a(),c,d=f+4,p=0;p<=l;++p){var y=f+4+p*t;if(p==l||u[y>>o]==0){var b=y-d,m=n(d,b);c===void 0?c=m:(c+=String.fromCharCode(0),c+=m),d=y+t}}return F(f),c},toWireType:function(f,l){typeof l!="string"&&g("Cannot pass non-string to C++ string type "+r);var u=s(l),c=he(4+u+t);return T[c>>2]=u>>o,i(l,c+4,u+t),f!==null&&f.push(F,c),c},argPackAdvance:8,readValueFromPointer:pe,destructorFunction:function(f){F(f)}})}function Jr(e,t){t=$(t),A(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,n){}})}function Gr(){throw 1/0}function Xr(e,t,r,n,i,a,s){return-52}function qr(e,t,r,n,i,a){}function Yr(){rt("")}var mt;mt=()=>performance.now();function Kr(e,t,r){_.copyWithin(e,t,t+r)}function Qr(){return 2147483648}function Zr(e){var t=V.buffer;try{return V.grow(e-t.byteLength+65535>>>16),le(),1}catch{}}function Nr(e){var t=_.length;e=e>>>0;var r=Qr();if(e>r)return!1;for(var n=(f,l)=>f+(l-f%l)%l,i=1;i<=4;i*=2){var a=t*(1+.2/i);a=Math.min(a,e+100663296);var s=Math.min(r,n(Math.max(e,a),65536)),o=Zr(s);if(o)return!0}return!1}function en(e){throw"exit("+e+")"}var tn=en;function rn(e){return 52}function nn(e,t,r,n){return 52}function sn(e,t,r,n,i){return 70}var an=[null,[],[]];function on(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;return at.decode(e.buffer?e.subarray(t,i):new Uint8Array(e.slice(t,i)))}function ln(e,t){var r=an[e];t===0||t===10?((e===1?Ge:Xe)(on(r,0)),r.length=0):r.push(t)}function fn(e,t,r,n){for(var i=0,a=0;a<r;a++){var s=T[t>>2],o=T[t+4>>2];t+=8;for(var f=0;f<o;f++)ln(e,_[s+f]);i+=o}return T[n>>2]=i,0}Vt();H=v.BindingError=We(Error,"BindingError");lt=v.InternalError=We(Error,"InternalError");sr();Qt();pr();pt=v.UnboundTypeError=We(Error,"UnboundTypeError");Ar();var un={a:Et,k:Ot,F:Ut,A:Wt,I:Rt,D:jt,m:It,E:Lt,t:Ht,q:zt,j:wr,y:Cr,c:$r,b:Tr,J:kr,o:Or,f:Dr,d:Mr,p:Rr,l:zr,r:Jr,x:Gr,B:Xr,C:qr,e:Yr,g:mt,G:Kr,z:Nr,h:tn,i:rn,n:nn,s:sn,H:fn,w:cn,u:gn,v:dn};function cn(e,t,r){var n=ye();try{return Q(e)(t,r)}catch(i){if(me(n),i!==i+0)throw i;ve(1,0)}}function dn(e,t,r,n,i){var a=ye();try{return Q(e)(t,r,n,i)}catch(s){if(me(a),s!==s+0)throw s;ve(1,0)}}function gn(e,t,r,n){var i=ye();try{return Q(e)(t,r,n)}catch(a){if(me(i),a!==a+0)throw a;ve(1,0)}}function pn(e){e.L()}var Je={a:un},he,F,bt,ve,ye,me;(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(fetch("jassub-worker.wasm"),Je):WebAssembly.instantiate(v.wasm,Je)).then(function(e){asm=(e.instance||e).exports,he=asm.M,F=asm.N,bt=asm.O,asm.P,ve=asm.R,ye=asm.S,me=asm.T,asm.U,asm.V,asm.W,asm.X,st=asm.Q,V=asm.K,le(),pn(asm),qe()});
